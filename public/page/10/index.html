<!doctype html>



  


<html class="theme-next mist use-motion">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>



<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />












  
  
  <link href="/vendors/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />




  
  
  
  

  
    
    
  

  

  

  

  

  
    
    
    <link href="//fonts.googleapis.com/css?family=Lato:300,300italic,400,400italic,700,700italic&subset=latin,latin-ext" rel="stylesheet" type="text/css">
  






<link href="/vendors/font-awesome/css/font-awesome.min.css?v=4.4.0" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.0.1" rel="stylesheet" type="text/css" />


  <meta name="keywords" content="计算机 比特币 互联网金融 IFWallet" />








  <link rel="shortcut icon" type="image/x-icon" href="/favicon.ico?v=5.0.1" />






<meta name="description" content="区块链爱好者，互联网从业者">
<meta name="keywords" content="bibodeng, blockchain, bitcoin, bitcoin cash, life, programmer">
<meta property="og:type" content="website">
<meta property="og:title" content="bibodeng">
<meta property="og:url" content="https://bibodeng.github.io/page/10/index.html">
<meta property="og:site_name" content="bibodeng">
<meta property="og:description" content="区块链爱好者，互联网从业者">
<meta property="og:locale" content="zh-Hans">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="bibodeng">
<meta name="twitter:description" content="区块链爱好者，互联网从业者">



<script type="text/javascript" id="hexo.configuration">
  var NexT = window.NexT || {};
  var CONFIG = {
    scheme: 'Mist',
    sidebar: {"position":"right","display":"post"},
    fancybox: true,
    motion: true,
    duoshuo: {
      userId: 0,
      author: '博主'
    }
  };
</script>

  <title> bibodeng </title>
</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  










  
  
    
  

  <div class="container one-collumn sidebar-position-right 
   page-home 
 ">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-meta ">
  

  <div class="custom-logo-site-title">
    <a href="/"  class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <span class="site-title">bibodeng</span>
      <span class="logo-line-after"><i></i></span>
    </a>
  </div>
  <p class="site-subtitle">Think By My Mind</p>
</div>

<div class="site-nav-toggle">
  <button>
    <span class="btn-bar"></span>
    <span class="btn-bar"></span>
    <span class="btn-bar"></span>
  </button>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-categories">
          <a href="/categories" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-th"></i> <br />
            
            分类
          </a>
        </li>
      
        
        <li class="menu-item menu-item-about">
          <a href="/about" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-user"></i> <br />
            
            关于
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />
            
            归档
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br />
            
            标签
          </a>
        </li>
      

      
    </ul>
  

  
</nav>

 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            
  <section id="posts" class="posts-expand">
    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2013/04/24/专注前端开发/" itemprop="url">
                  专注前端开发
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">发表于</span>
            <time itemprop="dateCreated" datetime="2013-04-24T20:32:59+08:00" content="2013-04-24">
              2013-04-24
            </time>
          </span>

          

          
            
          

          
	
          
          
             <span id="/2013/04/24/专注前端开发/" class="leancloud_visitors" data-flag-title="专注前端开发">
               &nbsp; | &nbsp;
               <span class="post-meta-item-icon">
                 <i class="fa fa-eye"></i>
               </span>
               <span class="post-meta-item-text">阅读次数 </span>
               <span class="leancloud-visitors-count"></span>
              </span>
          

          
        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            
<style type="text/css" _ue_org_tagname="style"></style>
<style type="text/css" _ue_org_tagname="style"></style>
<link type="text/css" rel="stylesheet" href="http://bibodeng.web-149.com/content/plugins/bibo_mark/article_bibo.css"> <div class="art_content">
    <p>
                2013-04-23 8:56:24    
    </p>
    <h3>
                写在前面    
    </h3>
    <p>
                上次“第一次面试”的时候，我的面试官告诉我：“你东西是有了，但是不够专”，其实之前我还在犹豫是走前端还是服务器道路，现在狠下心来，专注于前端开发，埋头理解前端原理，性能优化，高质量代码编写等。故而我找来了几本书——web前端修炼之道/HTML5/性能优化最佳实践。还好，我懂得怎么去找比较好的博客和书籍来看，去成为一个卓越的前端工程师。我想现在还来得及，至少确定了自己努力的方向，接下来的事情就好办了。之前在写ugeek GTD的时候，由于缺乏经验，一开始缺乏设计，写的代码乱七八糟，真的可以用惨不忍睹来形容，后来重写了一次，就好多了，看起来API很有规律，对我后来的开发很有好处。现在看来，大学期间需要折腾一些东西，折腾也要有方法，给自己一个期限，尽量在这个期限内弄懂一个知识点，找最好的博客，最好的书籍，吃透它。且不要太着急地写应用，做项目，做的再多，是错的，也没啥意义，当然在学习的过程中还是要动手做练习的。    
    </p>
    <p>
        <br>
    </p>
    <h3>
                深入前端    
    </h3>
    <p>
                需要准备哪些知识：看图<br>
    </p>
    <p>
                百度百科-前端知识结构：<br>
    </p>
    <p>
        <img src="http://note.wiz.cn/unzip/3eb90c0e-f584-11e0-a072-00237def97cc/338bef13-6548-de07-2686-f505ae80d40e.6201/index_files/6df244913a76be4c540a9908f5542e98.jpg"><br>
    </p>
    <p>
                再看一个更加全面的：    
    </p>
    <p>
        <img src="http://note.wiz.cn/unzip/3eb90c0e-f584-11e0-a072-00237def97cc/338bef13-6548-de07-2686-f505ae80d40e.6201/index_files/5c31f8ed0d49fe5076cdfd9c0acbc2a6.jpg"><br>
    </p>
    <p>
        <br>
    </p>
    <p>
                adang哥的《web前端开发修炼之道》里面说：“精一行，通十行”，干前端的要懂很多东西，例如服务器编程，svn，算法数据结构，css/html/js更加是不用说了。我自己是在大学里正儿八经学习C/C++成长起来的程序员，是因为搞过一两个web应用，什么都要自己动手，接触了python，php等服务器端脚本语言，django，thinkphp等服务器端框架。当然，又要自己设计页面，P图，写html/CSS，当然还有js。一下子干这么多，肯定会有很多东西不精，所以也抗不起面试官几次问。如果要去大公司，是要做“最好的螺丝钉”，所以最好专注特定的一个领域。很显然，学校的教育和企业的需求还是相差很大的。攒的一些项目经验都是课余时间写的，正经觉得比较有用的都是那些基础原理课（数据结构/算法），真心觉得，能达到tencent要求的都是神人。现在也没什么好说的，老老实实啃书，下面是小倪哥的推荐书单：    
    </p>
    <p style="text-align:left;">
        <img src="http://note.wiz.cn/unzip/3eb90c0e-f584-11e0-a072-00237def97cc/338bef13-6548-de07-2686-f505ae80d40e.6201/index_files/07e4b91b93ab14695183fd55582fb526.png">     </p>
    <p>
                看到这个的时候，我想起了陈近南的一句话“这只是武林秘籍的目录，那堆才是绝世武功的书”，老实说，还没有正式学过js的我，知道有的学了。我想十年才能说是小有所成吧。最重要的大家都很急躁，想要一步登天，谁知道徒添焦虑，要明白，最重要的是修炼功夫。    
    </p>
    <p>
        <br>
    </p>
    <h3>
                推荐阅读    
    </h3>
    <h4>
                浏览器渲染过程    
    </h4>
    <p>
                特别针对浏览器的原理，与服务器的交互，怎样写出高效的css和js代码。例如，浏览器是怎样处理文档的，其大概过程如下：<br>
    </p>
    <ol style="list-style-type:decimal;" class=" list-paddingleft-2">
        <li>
            <p>
                <br>
            </p>
        </li>
        <li>
            <p>
                                解析文档            
            </p>
        </li>
    </ol>
    <ul class=" list-paddingleft-2">
        <li>
            <p>
                                根据文档构建DOM树            
            </p>
        </li>
    </ul>
    <ul class=" list-paddingleft-2">
        <li>
            <p>
                                根据CSS构建渲染树            
            </p>
        </li>
    </ul>
    <ul class=" list-paddingleft-2">
        <li>
            <p>
                                绘制图像            
            </p>
        </li>
    </ul>
    <ol class=" list-paddingleft-2">
        <li>
            <p>
                <br>
            </p>
        </li>
    </ol>
    <p>
                  可以参考：<a href="http://www.smallni.com/css-performance-from-the-browsers-rendering/" target="_blank">浏览器渲染过程</a>     </p>
    <p>
        <br>
    </p>
    <h4>
                浏览器重排与重绘    
    </h4>
    <p>
                而对于浏览器的重绘和重排问题，又有许多值得研究的东西，写的js，如果做少传送数据，还要做到少改动DOM树，避免频繁的重绘和重排。重绘可能是一些css属性的改变，重排则是文档结构的改变，有时候DOM改变或者元素大小改变了，会影响到布局，所以要重排，而且肯定要重绘。具体可可以参考：<a href="http://kb.cnblogs.com/page/169820/" target="_blank">浏览器重绘与重排</a>     </p>
    <p>
        <br>
    </p>
    <h4>
                原生ajax    
    </h4>
    <p>
                还有一个我注意到的问题是ajax的实现，我记得面试官叫我写一个ajax，我以为是用jquery写，所以就写了个$.ajax（url, arg, callback_function(){}）之类的东西，现在想起来，面试官应该是在考我原生的ajax是怎样的，后来我google一番，才知道是一个xmlHttpRequest，然后发送请求到url中，设置回调函数，发送请求，最后得到响应，参考<a href="http://www.smallni.com/ajax-demo/" target="_blank">ajax实现步骤</a>。    
    </p>
    <p>
        <br>
    </p>
    <p>
                看了一些这样的博文，我才知道要深入web前端，还要学习很多的东西，但是现在看来还不晚，还有一年的时间，扎实这些基础。    
    </p>
    <h3>
                友情链接    
    </h3>
    <p>
                汤姆大叔 <a href="http://www.cnblogs.com/TomXu/archive/2012/07/26/2581268.html" target="_blank"></a><a href="http://www.cnblogs.com/TomXu/archive/2012/07/26/2581268.html" target="_blank">http://www.cnblogs.com/TomXu/archive/2012/07/26/2581268.html</a>     </p>
    <p>
                叶小杈 <a href="http://www.cnblogs.com/yexiaochai/" target="_blank"></a><a href="http://www.cnblogs.com/yexiaochai/" target="_blank"></a><a href="http://www.cnblogs.com/yexiaochai/" target="_blank">http://www.cnblogs.com/yexiaochai/</a>     </p>
    <p>
                腾讯小倪 <a href="http://www.smallni.com/" target="_blank"></a><a href="http://www.smallni.com/" target="_blank">http://www.smallni.com/</a>     </p>
    <p>
        <a href="http://www.smallni.com/" target="_blank"></a>web前端网址导航 <a href="http://www.ux265.net/" target="_blank">http://www.ux265.net/</a><br>
    </p>
    <p>
                李忠谈web从小工到大家 <a href="http://blog.leezhong.com/tech/2010/12/18/web-development-journeyman-master.html" target="_blank">http://blog.leezhong.com/tech/2010/12/18/web-development-journeyman-master.html</a>     </p>
    <p>
        <br>
    </p>
    <h3>
                END    
    </h3>
    <p>
                找本《javascript 高级程序设计》边儿开看吧。<br>
    </p>
    <p>
                by bibodeng 2013-04-24 20:23:49<br>
    </p>
    <p>
        <br>
    </p>
    <p>
        <br>
    </p>
</div>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2013/04/21/堆排序复习/" itemprop="url">
                  堆排序复习
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">发表于</span>
            <time itemprop="dateCreated" datetime="2013-04-21T21:58:29+08:00" content="2013-04-21">
              2013-04-21
            </time>
          </span>

          

          
            
          

          
	
          
          
             <span id="/2013/04/21/堆排序复习/" class="leancloud_visitors" data-flag-title="堆排序复习">
               &nbsp; | &nbsp;
               <span class="post-meta-item-icon">
                 <i class="fa fa-eye"></i>
               </span>
               <span class="post-meta-item-text">阅读次数 </span>
               <span class="leancloud-visitors-count"></span>
              </span>
          

          
        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            
<p style="margin-top:0px;margin-bottom:0px;font-family:'Times New Roman';font-size:15px;letter-spacing:1px;line-height:19.5px;">2013-04-21&nbsp;翻阅《算法导论》</p>
<h3 style="background-color:#000000;color:#ffffff;padding:10px;font-family:'Times New Roman';letter-spacing:1px;line-height:19.5px;">再谈堆排序</h3>
<p style="margin-top:0px;margin-bottom:0px;font-family:'Times New Roman';font-size:15px;letter-spacing:1px;line-height:19.5px;">堆排序利用的特性——堆的数据结构特征：最大/最小&nbsp;的元素总是在根处取得。</p>
<p style="margin-top:0px;margin-bottom:0px;font-family:'Times New Roman';font-size:15px;letter-spacing:1px;line-height:19.5px;">那么要利用根来排序，我们只需要保持堆的特性，然后每次把最后的元素与根交换，取出根元素就可以了。但是这个过程需要用到整堆，即保证这个数组能够形成堆的特征（这里对最大堆来讲）：父节点总是比子节点要大。</p>
<p style="margin-top:0px;margin-bottom:0px;font-family:'Times New Roman';font-size:15px;letter-spacing:1px;line-height:19.5px;">整堆就是对这种“僭越”的清洗，说起来很残忍，其实就是如果比自己小的占用了上位，则和它交换，这样递归下去，就一定能够让整棵树变得“井井有条”。</p>
<p style="margin-top:0px;margin-bottom:0px;font-family:'Times New Roman';font-size:15px;letter-spacing:1px;line-height:19.5px;"></p>
<p style="margin-top:0px;margin-bottom:0px;font-family:'Times New Roman';font-size:15px;letter-spacing:1px;line-height:19.5px;">这次我用python来实现一个堆。</p>
<div id="highlighter_209101" class="syntaxhighlighter python" highlighter="brush:python;toolbar:false;" style="font-family:'Times New Roman';font-size:15px;letter-spacing:1px;line-height:19.5px;"><table border="0" cellpadding="0" cellspacing="0" style="clear:both;margin-bottom:10px;word-break:break-all;"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2" style="height:20px;">1</div>
<div class="line number2 index1 alt1" style="height:20px;">2</div>
<div class="line number3 index2 alt2" style="height:20px;">3</div>
<div class="line number4 index3 alt1" style="height:20px;">4</div>
<div class="line number5 index4 alt2" style="height:20px;">5</div>
<div class="line number6 index5 alt1" style="height:20px;">6</div>
<div class="line number7 index6 alt2" style="height:20px;">7</div>
<div class="line number8 index7 alt1" style="height:20px;">8</div>
<div class="line number9 index8 alt2" style="height:20px;">9</div>
<div class="line number10 index9 alt1" style="height:20px;">10</div>
<div class="line number11 index10 alt2" style="height:20px;">11</div>
<div class="line number12 index11 alt1" style="height:20px;">12</div>
<div class="line number13 index12 alt2" style="height:20px;">13</div>
<div class="line number14 index13 alt1" style="height:20px;">14</div>
<div class="line number15 index14 alt2" style="height:20px;">15</div>
<div class="line number16 index15 alt1" style="height:20px;">16</div>
<div class="line number17 index16 alt2" style="height:20px;">17</div>
<div class="line number18 index17 alt1" style="height:20px;">18</div>
<div class="line number19 index18 alt2" style="height:20px;">19</div>
<div class="line number20 index19 alt1" style="height:20px;">20</div>
<div class="line number21 index20 alt2" style="height:20px;">21</div>
<div class="line number22 index21 alt1" style="height:20px;">22</div>
<div class="line number23 index22 alt2" style="height:20px;">23</div>
<div class="line number24 index23 alt1" style="height:20px;">24</div>
<div class="line number25 index24 alt2" style="height:20px;">25</div>
<div class="line number26 index25 alt1" style="height:20px;">26</div>
<div class="line number27 index26 alt2" style="height:20px;">27</div>
<div class="line number28 index27 alt1" style="height:20px;">28</div>
<div class="line number29 index28 alt2" style="height:20px;">29</div>
<div class="line number30 index29 alt1" style="height:20px;">30</div>
<div class="line number31 index30 alt2" style="height:20px;">31</div>
<div class="line number32 index31 alt1" style="height:20px;">32</div>
<div class="line number33 index32 alt2" style="height:20px;">33</div>
<div class="line number34 index33 alt1" style="height:20px;">34</div>
<div class="line number35 index34 alt2" style="height:20px;">35</div>
<div class="line number36 index35 alt1" style="height:20px;">36</div>
<div class="line number37 index36 alt2" style="height:20px;">37</div>
<div class="line number38 index37 alt1" style="height:20px;">38</div>
<div class="line number39 index38 alt2" style="height:20px;">39</div>
<div class="line number40 index39 alt1" style="height:20px;">40</div>
<div class="line number41 index40 alt2" style="height:20px;">41</div>
<div class="line number42 index41 alt1" style="height:20px;">42</div>
<div class="line number43 index42 alt2" style="height:20px;">43</div>
<div class="line number44 index43 alt1" style="height:20px;">44</div>
<div class="line number45 index44 alt2" style="height:20px;">45</div>
<div class="line number46 index45 alt1" style="height:20px;">46</div>
<div class="line number47 index46 alt2" style="height:20px;">47</div>
<div class="line number48 index47 alt1" style="height:20px;">48</div>
<div class="line number49 index48 alt2" style="height:20px;">49</div>
<div class="line number50 index49 alt1" style="height:20px;">50</div>
<div class="line number51 index50 alt2" style="height:20px;">51</div>
<div class="line number52 index51 alt1" style="height:20px;">52</div>
<div class="line number53 index52 alt2" style="height:20px;">53</div>
<div class="line number54 index53 alt1" style="height:20px;">54</div>
<div class="line number55 index54 alt2" style="height:20px;">55</div>
<div class="line number56 index55 alt1" style="height:20px;">56</div>
<div class="line number57 index56 alt2" style="height:20px;">57</div>
<div class="line number58 index57 alt1" style="height:20px;">58</div>
<div class="line number59 index58 alt2" style="height:20px;">59</div>
<div class="line number60 index59 alt1" style="height:20px;">60</div>
<div class="line number61 index60 alt2" style="height:20px;">61</div>
<div class="line number62 index61 alt1" style="height:20px;">62</div>
<div class="line number63 index62 alt2" style="height:20px;">63</div>
<div class="line number64 index63 alt1" style="height:20px;">64</div>
<div class="line number65 index64 alt2" style="height:20px;">65</div>
<div class="line number66 index65 alt1" style="height:20px;">66</div>
<div class="line number67 index66 alt2" style="height:20px;">67</div>
<div class="line number68 index67 alt1" style="height:20px;">68</div>
<div class="line number69 index68 alt2" style="height:20px;">69</div>
<div class="line number70 index69 alt1" style="height:20px;">70</div>
<div class="line number71 index70 alt2" style="height:20px;">71</div>
<div class="line number72 index71 alt1" style="height:20px;">72</div>
<div class="line number73 index72 alt2" style="height:20px;">73</div>
<div class="line number74 index73 alt1" style="height:20px;">74</div>
<div class="line number75 index74 alt2" style="height:20px;">75</div>
<div class="line number76 index75 alt1" style="height:20px;">76</div>
<div class="line number77 index76 alt2" style="height:20px;">77</div>
<div class="line number78 index77 alt1" style="height:20px;">78</div>
<div class="line number79 index78 alt2" style="height:20px;">79</div>
<div class="line number80 index79 alt1" style="height:20px;">80</div>
<div class="line number81 index80 alt2" style="height:20px;">81</div>
<div class="line number82 index81 alt1" style="height:20px;">82</div>
<div class="line number83 index82 alt2" style="height:20px;">83</div>
<div class="line number84 index83 alt1" style="height:20px;">84</div>
<div class="line number85 index84 alt2" style="height:20px;">85</div>
<div class="line number86 index85 alt1" style="height:20px;">86</div>
<div class="line number87 index86 alt2" style="height:20px;">87</div>
<div class="line number88 index87 alt1" style="height:20px;">88</div>
<div class="line number89 index88 alt2" style="height:20px;">89</div>
<div class="line number90 index89 alt1" style="height:20px;">90</div>
<div class="line number91 index90 alt2" style="height:20px;">91</div>
<div class="line number92 index91 alt1" style="height:20px;">92</div>
<div class="line number93 index92 alt2" style="height:20px;">93</div>
<div class="line number94 index93 alt1" style="height:20px;">94</div>
</td>
<td class="code"><div class="container"><div class="line number1 index0 alt2" style="height:20px;"><code class="python comments">#!/usr/bin/python</code></div>
<div class="line number2 index1 alt1" style="height:20px;"><code class="python comments"># -*- coding: utf-8 -*-</code></div>
<div class="line number3 index2 alt2" style="height:20px;"><code class="python comments">'''</code></div>
<div class="line number4 index3 alt1" style="height:20px;"><code class="python comments"># heapsort of python</code></div>
<div class="line number5 index4 alt2" style="height:20px;"><code class="python comments"># by bibodeng</code></div>
<div class="line number6 index5 alt1" style="height:20px;"><code class="python comments"># 2013-04-21</code></div>
<div class="line number7 index6 alt2" style="height:20px;"><code class="python comments">'''</code></div>
<div class="line number8 index7 alt1" style="height:20px;"><code class="python plain">DEBUG</code><code class="python keyword">=</code><code class="python value">1</code></div>
<div class="line number9 index8 alt2" style="height:20px;"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code>&nbsp;</div>
<div class="line number10 index9 alt1" style="height:20px;"><code class="python keyword">class</code>&nbsp;<code class="python plain">heap_sort:</code></div>
<div class="line number11 index10 alt2" style="height:20px;"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">array&nbsp;</code><code class="python keyword">=</code>&nbsp;<code class="python plain">[]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python comments">#the array to be sort</code></div>
<div class="line number12 index11 alt1" style="height:20px;"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">heap_size&nbsp;</code><code class="python keyword">=</code>&nbsp;<code class="python value">0</code></div>
<div class="line number13 index12 alt2" style="height:20px;"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code>&nbsp;</div>
<div class="line number14 index13 alt1" style="height:20px;"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python keyword">def</code>&nbsp;<code class="python plain">__init__(</code><code class="python color1">self</code><code class="python plain">, array):</code></div>
<div class="line number15 index14 alt2" style="height:20px;"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python color1">self</code><code class="python plain">.array&nbsp;</code><code class="python keyword">=</code>&nbsp;<code class="python plain">array&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python comments">#the array to be sort</code></div>
<div class="line number16 index15 alt1" style="height:20px;"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python color1">self</code><code class="python plain">.heap_size&nbsp;</code><code class="python keyword">=</code>&nbsp;<code class="python functions">len</code><code class="python plain">(</code><code class="python color1">self</code><code class="python plain">.array)&nbsp;</code><code class="python keyword">-</code>&nbsp;<code class="python value">1</code></div>
<div class="line number17 index16 alt2" style="height:20px;"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python comments">'''print self.array</code></div>
<div class="line number18 index17 alt1" style="height:20px;"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python comments">print self.heap_size'''</code></div>
<div class="line number19 index18 alt2" style="height:20px;"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code>&nbsp;</div>
<div class="line number20 index19 alt1" style="height:20px;"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python comments"># find the parent node index in array</code></div>
<div class="line number21 index20 alt2" style="height:20px;"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python keyword">def</code>&nbsp;<code class="python plain">parent(</code><code class="python color1">self</code><code class="python plain">,i):</code></div>
<div class="line number22 index21 alt1" style="height:20px;"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python keyword">return</code>&nbsp;<code class="python plain">i&gt;&gt;</code><code class="python value">1</code></div>
<div class="line number23 index22 alt2" style="height:20px;"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code>&nbsp;</div>
<div class="line number24 index23 alt1" style="height:20px;"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python keyword">def</code>&nbsp;<code class="python plain">left_child(</code><code class="python color1">self</code><code class="python plain">,i):</code></div>
<div class="line number25 index24 alt2" style="height:20px;"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python keyword">return</code>&nbsp;<code class="python plain">(i&lt;&lt;</code><code class="python value">1</code><code class="python plain">)&nbsp;</code><code class="python keyword">+</code>&nbsp;<code class="python value">1</code></div>
<div class="line number26 index25 alt1" style="height:20px;"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code>&nbsp;</div>
<div class="line number27 index26 alt2" style="height:20px;"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python keyword">def</code>&nbsp;<code class="python plain">right_child(</code><code class="python color1">self</code><code class="python plain">,i):</code></div>
<div class="line number28 index27 alt1" style="height:20px;"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python keyword">return</code>&nbsp;<code class="python plain">(i&lt;&lt;</code><code class="python value">1</code><code class="python plain">)&nbsp;</code><code class="python keyword">+</code>&nbsp;<code class="python value">2</code></div>
<div class="line number29 index28 alt2" style="height:20px;"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code>&nbsp;</div>
<div class="line number30 index29 alt1" style="height:20px;"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python keyword">def</code>&nbsp;<code class="python plain">heap_max(</code><code class="python color1">self</code><code class="python plain">):</code></div>
<div class="line number31 index30 alt2" style="height:20px;"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python keyword">return</code>&nbsp;<code class="python color1">self</code><code class="python plain">.array[</code><code class="python value">0</code><code class="python plain">]</code></div>
<div class="line number32 index31 alt1" style="height:20px;"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code>&nbsp;</div>
<div class="line number33 index32 alt2" style="height:20px;"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python keyword">def</code>&nbsp;<code class="python plain">swap(</code><code class="python color1">self</code><code class="python plain">,x,y):</code></div>
<div class="line number34 index33 alt1" style="height:20px;"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python keyword">return</code>&nbsp;<code class="python plain">y,x</code></div>
<div class="line number35 index34 alt2" style="height:20px;"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code>&nbsp;</div>
<div class="line number36 index35 alt1" style="height:20px;"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python comments"># make the array fit heap from node i</code></div>
<div class="line number37 index36 alt2" style="height:20px;"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python keyword">def</code>&nbsp;<code class="python plain">max_heapify(</code><code class="python color1">self</code><code class="python plain">, i):&nbsp;&nbsp;</code></div>
<div class="line number38 index37 alt1" style="height:20px;"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python comments"># judge the i is smaller than his child</code></div>
<div class="line number39 index38 alt2" style="height:20px;"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">l&nbsp;</code><code class="python keyword">=</code>&nbsp;<code class="python color1">self</code><code class="python plain">.left_child(i)</code></div>
<div class="line number40 index39 alt1" style="height:20px;"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">r&nbsp;</code><code class="python keyword">=</code>&nbsp;<code class="python color1">self</code><code class="python plain">.right_child(i)</code></div>
<div class="line number41 index40 alt2" style="height:20px;"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">largest&nbsp;&nbsp;</code><code class="python keyword">=</code>&nbsp;<code class="python plain">i</code></div>
<div class="line number42 index41 alt1" style="height:20px;"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python comments"># left</code></div>
<div class="line number43 index42 alt2" style="height:20px;"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python keyword">if</code>&nbsp;<code class="python plain">l &lt;</code><code class="python keyword">=</code>&nbsp;<code class="python color1">self</code><code class="python plain">.heap_size&nbsp;</code><code class="python keyword">and</code>&nbsp;<code class="python plain">array[i] &lt; array[l]:</code></div>
<div class="line number44 index43 alt1" style="height:20px;"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">largest&nbsp;</code><code class="python keyword">=</code>&nbsp;<code class="python plain">l</code></div>
<div class="line number45 index44 alt2" style="height:20px;"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python comments"># right</code></div>
<div class="line number46 index45 alt1" style="height:20px;"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python keyword">if</code>&nbsp;<code class="python plain">r &lt;</code><code class="python keyword">=</code>&nbsp;<code class="python color1">self</code><code class="python plain">.heap_size&nbsp;</code><code class="python keyword">and</code>&nbsp;<code class="python plain">array[largest] &lt; array[r] :</code></div>
<div class="line number47 index46 alt2" style="height:20px;"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">largest&nbsp;</code><code class="python keyword">=</code>&nbsp;<code class="python plain">r</code></div>
<div class="line number48 index47 alt1" style="height:20px;"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python comments"># exchange the largest with i</code></div>
<div class="line number49 index48 alt2" style="height:20px;"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python keyword">if</code>&nbsp;<code class="python plain">largest !</code><code class="python keyword">=</code>&nbsp;<code class="python plain">i:</code></div>
<div class="line number50 index49 alt1" style="height:20px;"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">array[i],array[largest]&nbsp;</code><code class="python keyword">=</code>&nbsp;<code class="python color1">self</code><code class="python plain">.swap(array[i], array[largest])</code></div>
<div class="line number51 index50 alt2" style="height:20px;"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python comments"># recur</code></div>
<div class="line number52 index51 alt1" style="height:20px;"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python color1">self</code><code class="python plain">.max_heapify(largest)</code></div>
<div class="line number53 index52 alt2" style="height:20px;"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code>&nbsp;</div>
<div class="line number54 index53 alt1" style="height:20px;"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code>&nbsp;</div>
<div class="line number55 index54 alt2" style="height:20px;"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python comments"># make the array is a heap</code></div>
<div class="line number56 index55 alt1" style="height:20px;"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python keyword">def</code>&nbsp;<code class="python plain">build_heap(</code><code class="python color1">self</code><code class="python plain">):</code></div>
<div class="line number57 index56 alt2" style="height:20px;"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python comments"># self.heap_size = self.array.len()</code></div>
<div class="line number58 index57 alt1" style="height:20px;"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python keyword">for</code>&nbsp;<code class="python plain">i&nbsp;</code><code class="python keyword">in</code>&nbsp;<code class="python functions">range</code><code class="python plain">((</code><code class="python color1">self</code><code class="python plain">.heap_size</code><code class="python keyword">/</code><code class="python value">2</code><code class="python plain">),&nbsp;</code><code class="python keyword">-</code><code class="python value">1</code><code class="python plain">,&nbsp;</code><code class="python keyword">-</code><code class="python value">1</code><code class="python plain">):</code></div>
<div class="line number59 index58 alt2" style="height:20px;"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python comments"># print "heapify node", i ,":", self.array[i]</code></div>
<div class="line number60 index59 alt1" style="height:20px;"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python color1">self</code><code class="python plain">.max_heapify(i)</code></div>
<div class="line number61 index60 alt2" style="height:20px;"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code>&nbsp;</div>
<div class="line number62 index61 alt1" style="height:20px;"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code>&nbsp;</div>
<div class="line number63 index62 alt2" style="height:20px;"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python keyword">def</code>&nbsp;<code class="python plain">h_sort(</code><code class="python color1">self</code><code class="python plain">):</code></div>
<div class="line number64 index63 alt1" style="height:20px;"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python functions">print</code>&nbsp;<code class="python string">"before build: "</code><code class="python plain">,</code><code class="python color1">self</code><code class="python plain">.array</code></div>
<div class="line number65 index64 alt2" style="height:20px;"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python comments"># first , build heap</code></div>
<div class="line number66 index65 alt1" style="height:20px;"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python color1">self</code><code class="python plain">.build_heap()</code></div>
<div class="line number67 index66 alt2" style="height:20px;"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python comments"># second get the heap node by order</code></div>
<div class="line number68 index67 alt1" style="height:20px;"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python comments"># print self.heap_size</code></div>
<div class="line number69 index68 alt2" style="height:20px;"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python functions">print</code>&nbsp;<code class="python string">"after build: "</code><code class="python plain">,</code><code class="python color1">self</code><code class="python plain">.array</code></div>
<div class="line number70 index69 alt1" style="height:20px;"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python keyword">for</code>&nbsp;<code class="python plain">i&nbsp;</code><code class="python keyword">in</code>&nbsp;<code class="python functions">range</code><code class="python plain">(</code><code class="python color1">self</code><code class="python plain">.heap_size,&nbsp;</code><code class="python keyword">-</code><code class="python value">1</code><code class="python plain">,&nbsp;</code><code class="python keyword">-</code><code class="python value">1</code><code class="python plain">):</code></div>
<div class="line number71 index70 alt2" style="height:20px;"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python comments"># get root</code></div>
<div class="line number72 index71 alt1" style="height:20px;"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python keyword">print</code>&nbsp;<code class="python string">"the "</code><code class="python plain">,i,</code><code class="python string">"num : "</code><code class="python plain">,&nbsp;</code><code class="python color1">self</code><code class="python plain">.heap_max()</code></div>
<div class="line number73 index72 alt2" style="height:20px;"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python color1">self</code><code class="python plain">.array[</code><code class="python value">0</code><code class="python plain">]&nbsp;</code><code class="python keyword">=</code>&nbsp;<code class="python color1">self</code><code class="python plain">.array[i]</code></div>
<div class="line number74 index73 alt1" style="height:20px;"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python keyword">del</code>&nbsp;<code class="python color1">self</code><code class="python plain">.array[i]</code></div>
<div class="line number75 index74 alt2" style="height:20px;"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python color1">self</code><code class="python plain">.heap_size&nbsp;</code><code class="python keyword">-</code><code class="python keyword">=</code>&nbsp;<code class="python value">1</code></div>
<div class="line number76 index75 alt1" style="height:20px;"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python comments"># heapify the array</code></div>
<div class="line number77 index76 alt2" style="height:20px;"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python color1">self</code><code class="python plain">.max_heapify(</code><code class="python value">0</code><code class="python plain">)</code></div>
<div class="line number78 index77 alt1" style="height:20px;"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code>&nbsp;</div>
<div class="line number79 index78 alt2" style="height:20px;"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code>&nbsp;</div>
<div class="line number80 index79 alt1" style="height:20px;"><code class="python comments"># call the program to run</code></div>
<div class="line number81 index80 alt2" style="height:20px;"><code class="python plain">array&nbsp;</code><code class="python keyword">=</code>&nbsp;<code class="python plain">[]</code></div>
<div class="line number82 index81 alt1" style="height:20px;"><code class="python keyword">if</code>&nbsp;<code class="python plain">DEBUG&nbsp;</code><code class="python keyword">=</code><code class="python keyword">=</code>&nbsp;<code class="python value">1</code><code class="python plain">:</code></div>
<div class="line number83 index82 alt2" style="height:20px;"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">array.extend([</code><code class="python value">3</code><code class="python plain">,</code><code class="python value">2</code><code class="python plain">,</code><code class="python value">5</code><code class="python plain">,</code><code class="python value">4</code><code class="python plain">,</code><code class="python value">6</code><code class="python plain">,</code><code class="python value">9</code><code class="python plain">,</code><code class="python value">1</code><code class="python plain">,</code><code class="python value">10</code><code class="python plain">,</code><code class="python value">20</code><code class="python plain">])</code></div>
<div class="line number84 index83 alt1" style="height:20px;"><code class="python keyword">else</code><code class="python plain">:</code></div>
<div class="line number85 index84 alt2" style="height:20px;"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">tmp&nbsp;</code><code class="python keyword">=</code>&nbsp;<code class="python functions">int</code><code class="python plain">(</code><code class="python functions">raw_input</code><code class="python plain">(</code><code class="python string">"input one number :"</code><code class="python plain">))</code></div>
<div class="line number86 index85 alt1" style="height:20px;"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python keyword">while</code><code class="python plain">(tmp &gt;&nbsp;</code><code class="python value">0</code><code class="python plain">):</code></div>
<div class="line number87 index86 alt2" style="height:20px;"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">array.append(tmp);</code></div>
<div class="line number88 index87 alt1" style="height:20px;"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">tmp&nbsp;</code><code class="python keyword">=</code>&nbsp;<code class="python functions">int</code><code class="python plain">(</code><code class="python functions">raw_input</code><code class="python plain">(</code><code class="python string">"input one number :"</code><code class="python plain">))</code></div>
<div class="line number89 index88 alt2" style="height:20px;"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code>&nbsp;</div>
<div class="line number90 index89 alt1" style="height:20px;"><code class="python comments"># 正式验证程序功能&nbsp;</code></div>
<div class="line number91 index90 alt2" style="height:20px;"><code class="python plain">sort_example&nbsp;</code><code class="python keyword">=</code>&nbsp;<code class="python plain">heap_sort(array)</code></div>
<div class="line number92 index91 alt1" style="height:20px;"><code class="python plain">sort_example.h_sort()</code></div>
<div class="line number93 index92 alt2" style="height:20px;"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code>&nbsp;</div>
<div class="line number94 index93 alt1" style="height:20px;"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code>&nbsp;</div>
</div>
</td>
</tr>
</tbody>
</table>
</div>
<h3 style="background-color:#000000;color:#ffffff;padding:10px;font-family:'Times New Roman';letter-spacing:1px;line-height:19.5px;">优先队列</h3>
<p style="margin-top:0px;margin-bottom:0px;font-family:'Times New Roman';font-size:15px;letter-spacing:1px;line-height:19.5px;"></p>
<p style="margin-top:0px;margin-bottom:0px;font-family:'Times New Roman';font-size:15px;letter-spacing:1px;line-height:19.5px;">在堆的基础上，添加了增长key功能，这样增长后的元素要遵守堆的规则，在合适的地方排队。故而需要自底向上地整堆，如果比父节点大，就一直交换。<span style="line-height:1.3em;">其实堆本身就已经具备了优先队列的功能了，增加功能会变得更加灵活，因为优先权可能是会改变的。</span></p>
<p style="margin-top:0px;margin-bottom:0px;font-family:'Times New Roman';font-size:15px;letter-spacing:1px;line-height:19.5px;"></p>
<p style="margin-top:0px;margin-bottom:0px;font-family:'Times New Roman';font-size:15px;letter-spacing:1px;line-height:19.5px;">添加一个插入功能，其实是在最后添加一个无穷小的元素（这样就可以理所当然地排在最后），然后对它进行增长key，然后它的位置就改变了。</p>
<p style="margin-top:0px;margin-bottom:0px;font-family:'Times New Roman';font-size:15px;letter-spacing:1px;line-height:19.5px;"></p>
<p style="margin-top:0px;margin-bottom:0px;font-family:'Times New Roman';font-size:15px;letter-spacing:1px;line-height:19.5px;">by&nbsp;bibodeng&nbsp;&nbsp;2013-04-21&nbsp;21:54:21</p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2013/04/20/不仅仅是优秀/" itemprop="url">
                  不仅仅是优秀
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">发表于</span>
            <time itemprop="dateCreated" datetime="2013-04-20T16:54:19+08:00" content="2013-04-20">
              2013-04-20
            </time>
          </span>

          

          
            
          

          
	
          
          
             <span id="/2013/04/20/不仅仅是优秀/" class="leancloud_visitors" data-flag-title="不仅仅是优秀">
               &nbsp; | &nbsp;
               <span class="post-meta-item-icon">
                 <i class="fa fa-eye"></i>
               </span>
               <span class="post-meta-item-text">阅读次数 </span>
               <span class="leancloud-visitors-count"></span>
              </span>
          

          
        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            
<div class="art_content" style="font-size:15px;letter-spacing:1px;line-height:1.3em;"><h3 style="background-color:#000000;color:#ffffff;padding:10px;font-family:'Times New Roman';">受到的启发</h3>
<p style="margin-top:0px;margin-bottom:0px;font-family:'Times New Roman';">要做就做到最好，做到exordinary，也就是杰出。做事情做到嘛嘛底，并不能引起别人的注意，也不能在人群中脱颖而出。而要做到很棒，才能让人记住你。上次在面试中，受到了一点点刺激，所以现在我又回到了“激情，勇气，火力全开”的状态。</p>
<h3 style="background-color:#000000;color:#ffffff;padding:10px;font-family:'Times New Roman';">不仅仅是优秀</h3>
<p style="margin-top:0px;margin-bottom:0px;font-family:'Times New Roman';">卓越，是优秀的人应该追求的境界。优秀，是啥都干的还好，不赖，但是离卓越还有那么一点距离。但是这个距离因为积累会越拉越远，并且人是处于一个熵增的状态，此时不干，将来想要成为卓越会更难了。卓越，是干的出色，漂亮，第一流的。可是，这需要很长时间的积累，以及正确的方法，正确的思想的指导。很有才干的人，最后的道德都不会差到哪里去。因为人生哲学和自然科学的目标都一样，使人的作用得以发挥，使物的作用得以发挥，从而实现人与物的价值。</p>
<h3 style="background-color:#000000;color:#ffffff;padding:10px;font-family:'Times New Roman';">做事的方式与精神状态</h3>
<p style="margin-top:0px;margin-bottom:0px;font-family:'Times New Roman';">做任何事情其实都是有技术的，包括与人维持感情，安排自己的生活，更加明显的就是编程这样需要训练的技能。既然是技术，而且有前人的不断努力得到的经验，那么我们就没有理由重新再来一遍。所以继承前人留下来的无穷的遗产，会使得我们成为一个“富人”。所以，要听取前贤们的意见和指导，注意是“贤”人的。所以对于修习学科来讲，找经典，读别人思考留下的精华，才是对我们最大的帮助。</p>
<p style="margin-top:0px;margin-bottom:0px;font-family:'Times New Roman';"></p>
<p style="margin-top:0px;margin-bottom:0px;font-family:'Times New Roman';">既然是技术，那就需要从改变认知开始（启发，打动你的思想），到改变行为（这就需要训练了）。当你达到了知行合一的时候，你基本上就所向无敌了，没有什么事情是你干不成的（只要不是异想天开的事情）。</p>
<p style="margin-top:0px;margin-bottom:0px;font-family:'Times New Roman';"></p>
<p style="margin-top:0px;margin-bottom:0px;font-family:'Times New Roman';">当然这样的求知的背后，是我们的一种态度。这种良好的向前贤看齐的心态，会不断鼓励你前进，去获取更加深奥的知识，从而获取更加大的力量。</p>
<h3 style="background-color:#000000;color:#ffffff;padding:10px;font-family:'Times New Roman';">小结</h3>
<p style="margin-top:0px;margin-bottom:0px;font-family:'Times New Roman';">《领悟》是最近很火的一首歌，但是我想说的不是感情上的领悟，而是知识上的领悟。有时侯，我们认知了一个事物，遇到了困难，苦思冥想，遇到高人指点了一下，或者是看到/听到其他东西启发了你一下，于是你顿悟了，理解畅通了，问题就解决了。记得我之前记下来的一句话“当你找到问题的本质时，问题就解决了”，这个世界上有许多的不可能，但是如果我们理解了我们所寻找的东西，那不断地找下去，总会找到问题的答案——我脑海中出现了二叉查找树的画面。</p>
<p style="margin-top:0px;margin-bottom:0px;font-family:'Times New Roman';"></p>
<p style="margin-top:0px;margin-bottom:0px;font-family:'Times New Roman';">by&nbsp;bibodeng&nbsp;&nbsp;&nbsp;&nbsp;2013-04-19&nbsp;&nbsp;&nbsp;21:09:18</p>
<p style="margin-top:0px;margin-bottom:0px;font-family:'Times New Roman';"></p>
<p style="margin-top:0px;margin-bottom:0px;font-family:'Times New Roman';"></p>
<p style="margin-top:0px;margin-bottom:0px;font-family:'Times New Roman';"></p>
<p style="margin-top:0px;margin-bottom:0px;font-family:'Times New Roman';"></p>
</div>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2013/04/20/C C++复仇记(下)/" itemprop="url">
                  C C++复仇记(下)
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">发表于</span>
            <time itemprop="dateCreated" datetime="2013-04-20T16:45:42+08:00" content="2013-04-20">
              2013-04-20
            </time>
          </span>

          

          
            
          

          
	
          
          
             <span id="/2013/04/20/C C++复仇记(下)/" class="leancloud_visitors" data-flag-title="C C++复仇记(下)">
               &nbsp; | &nbsp;
               <span class="post-meta-item-icon">
                 <i class="fa fa-eye"></i>
               </span>
               <span class="post-meta-item-text">阅读次数 </span>
               <span class="leancloud-visitors-count"></span>
              </span>
          

          
        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            
<h3 style="background-color:#000000;color:#ffffff;padding:10px;font-family:'Times New Roman';letter-spacing:1px;line-height:19.5px;"><br class="Apple-interchange-newline">
看好书</h3>
<p style="margin-top:0px;margin-bottom:0px;font-family:'Times New Roman';font-size:15px;letter-spacing:1px;line-height:19.5px;">​自从上次写了《C/C++复仇记(下)》以来，我继续看《C语言深度剖析》，理解了几个之前不懂的知识点，例如指针数组，数组指针，函数指针（平时从来不用）等。</p>
<p style="margin-top:0px;margin-bottom:0px;font-family:'Times New Roman';font-size:15px;letter-spacing:1px;line-height:19.5px;"></p>
<p style="margin-top:0px;margin-bottom:0px;font-family:'Times New Roman';font-size:15px;letter-spacing:1px;line-height:19.5px;">我甚至觉得C语言是一门很难的语言，之前认为容易，是因为只接触了容易的部分，当然这是相对而言的（python，java等高级语言都没有指针啥的，而且内存管理也轻松很多）。但是C作为我们大学里面学习的第一门语言，也是面试，笔试，考试，竞赛等等最常用到的语言，没有理由不好好学习之。而学习它，更多的是语言实现细节，不仅仅是语法细节，而实现细节在语言上的反映就是编译器的做法，比如函数，比如一个malloc函数，理解了它的实现，就可以知道为什么申请后要进行转化成特定类型的指针（因为用到了void*指针类型）等等，这些都需要深入理解，甚至是动手调试。</p>
<h3 style="background-color:#000000;color:#ffffff;padding:10px;font-family:'Times New Roman';letter-spacing:1px;line-height:19.5px;">C的指针和数组</h3>
<p style="margin-top:0px;margin-bottom:0px;font-family:'Times New Roman';font-size:15px;letter-spacing:1px;line-height:19.5px;">指针与数组的区别</p>
<p style="margin-top:0px;margin-bottom:0px;font-family:'Times New Roman';font-size:15px;letter-spacing:1px;line-height:19.5px;">书里面讲的很明白，数组和指针是完全不同的东西，相互之间也没有什么关联。只是它们的某些操作方法很相似，所以常常令我们迷惑。指针是一个地址，指向的是内存中的一块内存，它的类型只是表示它怎么解读内存里面的内容。如int *p = &amp;a[0]; 使得p指向数组的首元素的首地址，然后*(p+1)则表示下一个int型，是跨越了4个字节的（32位机）。当然也可以用下标的方式来访问： p[1]，其等价于 *（p+1），这就是迷惑我们的地方，因为数组也可以这样来访问。</p>
<p style="margin-top:0px;margin-bottom:0px;font-family:'Times New Roman';font-size:15px;letter-spacing:1px;line-height:19.5px;"></p>
<h4 style="font-family:'Times New Roman';font-size:15px;letter-spacing:1px;line-height:19.5px;">几个要说明的问题</h4>
<p style="margin-top:0px;margin-bottom:0px;font-family:'Times New Roman';font-size:15px;letter-spacing:1px;line-height:19.5px;">对指针进行加&nbsp;1&nbsp;操作,得到的是下一个元素的地址，而不是直接下一个字节的地址。</p>
<p style="margin-top:0px;margin-bottom:0px;font-family:'Times New Roman';font-size:15px;letter-spacing:1px;line-height:19.5px;">假设有 int a[10] = {0};</p>
<p style="margin-top:0px;margin-bottom:0px;font-family:'Times New Roman';font-size:15px;letter-spacing:1px;line-height:19.5px;">数组名a作为右值：</p>
<p style="margin-top:0px;margin-bottom:0px;font-family:'Times New Roman';font-size:15px;letter-spacing:1px;line-height:19.5px;">int (*p)[10]&nbsp;= &amp;a; &nbsp; // 将整个数组的首地址赋予数组指针， +1解读为跳10个int类型大小。指针是按照类型来确定下一个元素的位置的。</p>
<p style="margin-top:0px;margin-bottom:0px;font-family:'Times New Roman';font-size:15px;letter-spacing:1px;line-height:19.5px;">当 int *p = &amp;a;&nbsp;&nbsp; &nbsp; // 编译器将会警告，说类型转换，把数组地址赋给了int* p</p>
<p style="margin-top:0px;margin-bottom:0px;font-family:'Times New Roman';font-size:15px;letter-spacing:1px;line-height:19.5px;">当a作为右值时，和&amp;a[0]是一样的。也就是说可以这样用：</p>
<p style="margin-top:0px;margin-bottom:0px;font-family:'Times New Roman';font-size:15px;letter-spacing:1px;line-height:19.5px;">int x = *(a+1); &nbsp; &nbsp; &nbsp;// 表示数组的第二个元素赋值给x</p>
<p style="margin-top:0px;margin-bottom:0px;font-family:'Times New Roman';font-size:15px;letter-spacing:1px;line-height:19.5px;"></p>
<p style="margin-top:0px;margin-bottom:0px;font-family:'Times New Roman';font-size:15px;letter-spacing:1px;line-height:19.5px;">区别指针数组和数组的指针：</p>
<p style="margin-top:0px;margin-bottom:0px;font-family:'Times New Roman';font-size:15px;letter-spacing:1px;line-height:19.5px;">A),int&nbsp;*p1[10];&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;// 指针数组 int* p1[10] &nbsp;，[]的优先级比*高。</p>
<p style="margin-top:0px;margin-bottom:0px;font-family:'Times New Roman';font-size:15px;letter-spacing:1px;line-height:19.5px;">B),int&nbsp;(*p2)[10];&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp; // 数组指针 int (*)[10] &nbsp;p2, 指向10个元素数组的一个指针</p>
<p style="margin-top:0px;margin-bottom:0px;font-family:'Times New Roman';font-size:15px;letter-spacing:1px;line-height:19.5px;"></p>
<p style="margin-top:0px;margin-bottom:0px;font-family:'Times New Roman';font-size:15px;letter-spacing:1px;line-height:19.5px;"></p>
<p style="margin-top:0px;margin-bottom:0px;font-family:'Times New Roman';font-size:15px;letter-spacing:1px;line-height:19.5px;">理解指针和数组，最重要的是理解，指针是一个地址，指向一片内存，怎么解读内存关键在于起始地址和指针类型。而数组则是作为一个整体存在的，可以访问数组内的单个元素，但是其本身可以作为一种类型，可以有指向这种类型的指针。</p>
<h3 style="background-color:#000000;color:#ffffff;padding:10px;font-family:'Times New Roman';letter-spacing:1px;line-height:19.5px;">一种意识</h3>
<p style="margin-top:0px;margin-bottom:0px;font-family:'Times New Roman';font-size:15px;letter-spacing:1px;line-height:19.5px;">学习一种语言，到了一定的程度，应该养成了察觉错误的意识。错过一次后，找到犯错误的原因，也就不会错了。而往往我们犯错误，是因为我们的认知没有到位，没有搞清各个元素之间的关系。我们学习一样技能，总是克服原有的思维方法，重新确定其表达方式，归根结底都是一种映射，但是这种映射和我们潜意识中的内容可能有偏差，而阅读更多的知识，做更多的练习是减少这种偏差的唯一方法。加油！</p>
<h3 style="background-color:#000000;color:#ffffff;padding:10px;font-family:'Times New Roman';letter-spacing:1px;line-height:19.5px;">END</h3>
<p style="margin-top:0px;margin-bottom:0px;font-family:'Times New Roman';font-size:15px;letter-spacing:1px;line-height:19.5px;">by bibodeng&nbsp;2013-04-20&nbsp;16:44:12</p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2013/04/19/微信公众开发——使用消息接口/" itemprop="url">
                  微信公众开发——使用消息接口
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">发表于</span>
            <time itemprop="dateCreated" datetime="2013-04-19T09:49:51+08:00" content="2013-04-19">
              2013-04-19
            </time>
          </span>

          

          
            
          

          
	
          
          
             <span id="/2013/04/19/微信公众开发——使用消息接口/" class="leancloud_visitors" data-flag-title="微信公众开发——使用消息接口">
               &nbsp; | &nbsp;
               <span class="post-meta-item-icon">
                 <i class="fa fa-eye"></i>
               </span>
               <span class="post-meta-item-text">阅读次数 </span>
               <span class="leancloud-visitors-count"></span>
              </span>
          

          
        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            
<div class="art_content" style="font-size:15px;letter-spacing:1px;line-height:1.3em;"><h3 style="background-color:#000000;color:#ffffff;padding:10px;font-family:'Times New Roman';">﻿南苑随笔app</h3>
<p style="margin-top:0px;margin-bottom:0px;font-family:'Times New Roman';">之前写了一篇搭建sae的python平台，通过微信公众平台验证的博文。现在就是要承上启下，开始开发的第一步。也许你会说开发的第一步就是写代码。那我会对你表示鄙视，尽管南苑随笔是个很简单的应用，但是多少也还需要设计一下。确定一下需求，为了将来能够吸引到粉丝来关注我的公众号，我必须要定位好我的app，然后提供优秀的内容，并确定它的运营模式，才能进一步地提升我们的应用水准。</p>
<p style="margin-top:0px;margin-bottom:0px;font-family:'Times New Roman';"></p>
<h3 style="background-color:#000000;color:#ffffff;padding:10px;font-family:'Times New Roman';">需求分析</h3>
<p style="margin-top:0px;margin-bottom:0px;font-family:'Times New Roman';">首先，这个app是要用python写的，那么就一定要优雅一点，pythonic一点。对于我自己来说，我要使得这个app至少能够满足我阅读若干与南苑相关的文章的要求才行。故而需要对南苑随笔进行需求分析：</p>
<blockquote style="background-color:#ccff99;border-top-left-radius:5px;border-top-right-radius:5px;border-bottom-right-radius:5px;border-bottom-left-radius:5px;font-family:'Times New Roman';"><p style="margin-top:0px;margin-bottom:0px;"></p>
<p style="margin-top:0px;margin-bottom:0px;">定位：&nbsp;为南苑或者外校同学提供我们在南苑生活和学习的文章。文体不限，内容形式包括{图片，语音，文字}，推送给用户，这正是微信能够提供给我的。</p>
<p style="margin-top:0px;margin-bottom:0px;"></p>
<p style="margin-top:0px;margin-bottom:0px;">约定：&nbsp;允许投稿，但是投稿必须通过管理员的审核。其实很大程度上，我们是为了向粉丝们推介&nbsp;@bibo-果冻&nbsp;和&nbsp;@daoluan-郑思愿&nbsp;合作的那本《南苑随笔——IT小小鸟外传》。</p>
<p style="margin-top:0px;margin-bottom:0px;"></p>
<p style="margin-top:0px;margin-bottom:0px;">内容：&nbsp;校园生活，学习，感情，分享，趣味，摄影，文学作品，简单社交&nbsp;，歌曲等等。</p>
<p style="margin-top:0px;margin-bottom:0px;"></p>
<p style="margin-top:0px;margin-bottom:0px;">服务：&nbsp;提供每1天/2天定期推送文章或语音。同时相应用户发来的请求，对用户请求进行分析后返回所要求的内容。</p>
<p style="margin-top:0px;margin-bottom:0px;"></p>
<p style="margin-top:0px;margin-bottom:0px;">性能：&nbsp;要求服务器在5秒内返回用户的请求内容，在网络差的时候，这个就难说了。能够同时处理至少20位粉丝的请求（其实到底有没有这么多粉丝发来请求，我心里还是没有数啊）。</p>
</blockquote>
<h3 style="background-color:#000000;color:#ffffff;padding:10px;font-family:'Times New Roman';">系统设计</h3>
<p style="margin-top:0px;margin-bottom:0px;font-family:'Times New Roman';">这次，我吸取了上次的经验教训，要先完成逻辑和数据的设计，最后才去设计我们的交互界面（包括交互方式和菜单）。数据先行，那么一切就从构建起数据库开始。参照wordpress的博客数据库，就可以设计出基本的数据库框架。这部分就交给&nbsp;@daoluan-思愿&nbsp;来搞定，我相信他会完成的相当出色。</p>
<p style="margin-top:0px;margin-bottom:0px;font-family:'Times New Roman';"></p>
<p style="margin-top:0px;margin-bottom:0px;font-family:'Times New Roman';">本系统需要一个博客系统，和一个微信服务app,博客系统作为web端，用浏览器可访问的。而微信app则负责推送到用户的微信帐号聊天界面。故而我们的数据库设计就很清晰了，需要:</p>
<blockquote style="background-color:#ccff99;border-top-left-radius:5px;border-top-right-radius:5px;border-bottom-right-radius:5px;border-bottom-left-radius:5px;font-family:'Times New Roman';"><p style="margin-top:0px;margin-bottom:0px;">user表——用户</p>
<p style="margin-top:0px;margin-bottom:0px;">post表——文章</p>
<p style="margin-top:0px;margin-bottom:0px;">blog配置——博客的设置</p>
<p style="margin-top:0px;margin-bottom:0px;">category表——分类</p>
<p style="margin-top:0px;margin-bottom:0px;">———————————次要———————————</p>
<p style="margin-top:0px;margin-bottom:0px;">url表——友情链接</p>
<p style="margin-top:0px;margin-bottom:0px;">guest_book表——留言簿</p>
<p style="margin-top:0px;margin-bottom:0px;"></p>
</blockquote>
<p style="margin-top:0px;margin-bottom:0px;font-family:'Times New Roman';">而我需要用到的仅仅是博客系统数据库的一个子集——post表和guest_book表（也许会用到category表）。故而开发微信app则只需要自行创建两个表进行实验即可。</p>
<p style="margin-top:0px;margin-bottom:0px;font-family:'Times New Roman';"></p>
<h3 style="background-color:#000000;color:#ffffff;padding:10px;font-family:'Times New Roman';">发送消息试验</h3>
<p style="margin-top:0px;margin-bottom:0px;font-family:'Times New Roman';">暂且不把设计逻辑排到日程上来，我们来尝试一下在第三方服务器和微信服务器，以及客户端进行通信。假如用户发送来一个请求，由于已经绑定了URL，且开启了开发模式，那么就微信服务器就会转发这个请求到我们的服务器，我们的服务器要解析这个请求，然后返回所请求的内容。</p>
<p style="margin-top:0px;margin-bottom:0px;font-family:'Times New Roman';"></p>
<p style="margin-top:0px;margin-bottom:0px;font-family:'Times New Roman';">我们需要一个类来处理get请求，以及定时向微信服务器传送群发的文章。</p>
<p style="margin-top:0px;margin-bottom:0px;font-family:'Times New Roman';">该类&nbsp;weixin_scnuwriter设计如下：</p>
<blockquote style="background-color:#ccff99;border-top-left-radius:5px;border-top-right-radius:5px;border-bottom-right-radius:5px;border-bottom-left-radius:5px;font-family:'Times New Roman';"><p style="margin-top:0px;margin-bottom:0px;">handle_request(request)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;处理请求</p>
<p style="margin-top:0px;margin-bottom:0px;">parse_request_xml(xml)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;解析请求</p>
<p style="margin-top:0px;margin-bottom:0px;">response_msg(request)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;响应请求（关键逻辑部分）</p>
<p style="margin-top:0px;margin-bottom:0px;">pack_text_xml(post_msg,&nbsp;response_msg)&nbsp;&nbsp;#&nbsp;打包响应的文本内容，需要参考微信API，供response_msg调用</p>
</blockquote>
<p style="margin-top:0px;margin-bottom:0px;font-family:'Times New Roman';"></p>
<p style="margin-top:0px;margin-bottom:0px;font-family:'Times New Roman';">#&nbsp;另外在数据库方面要能够读取，需要django于数据库打交道，不过我们暂时不实现，只是做一个简单的测试。</p>
<p style="margin-top:0px;margin-bottom:0px;font-family:'Times New Roman';"></p>
<p style="margin-top:0px;margin-bottom:0px;font-family:'Times New Roman';">下面是handle_request代码：</p>
<div id="highlighter_8251" class="syntaxhighlighter python" highlighter="brush:python;toolbar:false;" style="font-family:'Times New Roman';"><table border="0" cellpadding="0" cellspacing="0" style="clear:both;margin-bottom:10px;word-break:break-all;"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div>
<div class="line number2 index1 alt1">2</div>
<div class="line number3 index2 alt2">3</div>
<div class="line number4 index3 alt1">4</div>
<div class="line number5 index4 alt2">5</div>
<div class="line number6 index5 alt1">6</div>
<div class="line number7 index6 alt2">7</div>
<div class="line number8 index7 alt1">8</div>
<div class="line number9 index8 alt2">9</div>
</td>
<td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="python keyword">def</code>&nbsp;<code class="python plain">handle_request(request):&nbsp;</code></div>
<div class="line number2 index1 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python keyword">if</code>&nbsp;<code class="python plain">request.method&nbsp;</code><code class="python keyword">=</code><code class="python keyword">=</code>&nbsp;<code class="python string">'GET'</code><code class="python plain">:&nbsp;</code></div>
<div class="line number3 index2 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">response&nbsp;</code><code class="python keyword">=</code>&nbsp;<code class="python plain">HttpResponse(check_signature(request),content_type</code><code class="python keyword">=</code><code class="python string">"text/plain"</code><code class="python plain">)&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python comments"># 如果是GET请求，那么核对签名</code></div>
<div class="line number4 index3 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python keyword">return</code>&nbsp;<code class="python plain">response</code></div>
<div class="line number5 index4 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python keyword">elif</code>&nbsp;<code class="python plain">request.method&nbsp;</code><code class="python keyword">=</code><code class="python keyword">=</code>&nbsp;<code class="python string">'POST'</code><code class="python plain">:&nbsp;&nbsp;</code></div>
<div class="line number6 index5 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">response&nbsp;</code><code class="python keyword">=</code>&nbsp;<code class="python plain">HttpResponse(response_msg(request),content_type</code><code class="python keyword">=</code><code class="python string">"application/xml"</code><code class="python plain">)&nbsp;&nbsp;</code><code class="python comments"># 如果是POST请求，那么响应消息</code></div>
<div class="line number7 index6 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python keyword">return</code>&nbsp;<code class="python plain">response&nbsp;</code></div>
<div class="line number8 index7 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python keyword">else</code><code class="python plain">:&nbsp;</code></div>
<div class="line number9 index8 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python keyword">return</code>&nbsp;<code class="python color1">None</code></div>
</div>
</td>
</tr>
</tbody>
</table>
</div>
<p style="margin-top:0px;margin-bottom:0px;font-family:'Times New Roman';">我们之前写认证的时候，都是直接将url导向到check_signature直接进行响应处理，但是这里我们对请求的类型进行区分，因为验证的时候发送的是GET请求，而对我们自己的服务器推送消息的时候，它是使用POST请求的，因为POST方法可以向服务器发送大量的数据（表单提交，文件上传等），在这里是xml结构。记得要在urls里面配置一个到handle_request的映射，我的是：“&nbsp;url(r'^$',&nbsp;handle_request), &nbsp;”。逗号是不能丢的。​</p>
<p style="margin-top:0px;margin-bottom:0px;font-family:'Times New Roman';"></p>
<p style="margin-top:0px;margin-bottom:0px;font-family:'Times New Roman';">handle_request需要调用check_signature,之前我们用了return&nbsp;HttpResponse(echoStr)来验证，但是我们把HttpResponse的封装放到了handle_request中，那么我们就只需在check_signature中返回echoStr就行了，当然，验证一次就行了，现在已经进入开发阶段，这函数将用不到。其实应该在一开始，我们就应该像现在一样写。check_signature如下：</p>
<div id="highlighter_837610" class="syntaxhighlighter python" highlighter="brush:python;toolbar:false;" style="font-family:'Times New Roman';"><table border="0" cellpadding="0" cellspacing="0" style="clear:both;margin-bottom:10px;word-break:break-all;"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div>
<div class="line number2 index1 alt1">2</div>
<div class="line number3 index2 alt2">3</div>
<div class="line number4 index3 alt1">4</div>
<div class="line number5 index4 alt2">5</div>
<div class="line number6 index5 alt1">6</div>
<div class="line number7 index6 alt2">7</div>
<div class="line number8 index7 alt1">8</div>
<div class="line number9 index8 alt2">9</div>
<div class="line number10 index9 alt1">10</div>
<div class="line number11 index10 alt2">11</div>
<div class="line number12 index11 alt1">12</div>
<div class="line number13 index12 alt2">13</div>
<div class="line number14 index13 alt1">14</div>
<div class="line number15 index14 alt2">15</div>
<div class="line number16 index15 alt1">16</div>
<div class="line number17 index16 alt2">17</div>
</td>
<td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="python comments"># 检测签名,只对get有效&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code></div>
<div class="line number2 index1 alt1"><code class="python keyword">def</code>&nbsp;<code class="python plain">check_signature(request):&nbsp;</code></div>
<div class="line number3 index2 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python keyword">global</code>&nbsp;<code class="python plain">TOKEN&nbsp;</code></div>
<div class="line number4 index3 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">signature&nbsp;</code><code class="python keyword">=</code>&nbsp;<code class="python plain">request.GET.get(</code><code class="python string">"signature"</code><code class="python plain">,&nbsp;</code><code class="python color1">None</code><code class="python plain">)</code></div>
<div class="line number5 index4 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">timestamp&nbsp;</code><code class="python keyword">=</code>&nbsp;<code class="python plain">request.GET.get(</code><code class="python string">"timestamp"</code><code class="python plain">,&nbsp;</code><code class="python color1">None</code><code class="python plain">)</code></div>
<div class="line number6 index5 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">nonce&nbsp;</code><code class="python keyword">=</code>&nbsp;<code class="python plain">request.GET.get(</code><code class="python string">"nonce"</code><code class="python plain">,&nbsp;</code><code class="python color1">None</code><code class="python plain">)</code></div>
<div class="line number7 index6 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">echoStr&nbsp;</code><code class="python keyword">=</code>&nbsp;<code class="python plain">request.GET.get(</code><code class="python string">"echostr"</code><code class="python plain">,</code><code class="python color1">None</code><code class="python plain">)</code></div>
<div class="line number8 index7 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">token&nbsp;</code><code class="python keyword">=</code>&nbsp;<code class="python plain">TOKEN&nbsp;</code></div>
<div class="line number9 index8 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">tmpList&nbsp;</code><code class="python keyword">=</code>&nbsp;<code class="python plain">[token,timestamp,nonce]&nbsp;</code></div>
<div class="line number10 index9 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">tmpList.sort()&nbsp;</code></div>
<div class="line number11 index10 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">tmpstr&nbsp;</code><code class="python keyword">=</code>&nbsp;<code class="python string">"%s%s%s"</code>&nbsp;<code class="python keyword">%</code>&nbsp;<code class="python functions">tuple</code><code class="python plain">(tmpList)&nbsp;</code></div>
<div class="line number12 index11 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">tmpstr&nbsp;</code><code class="python keyword">=</code>&nbsp;<code class="python plain">hashlib.sha1(tmpstr).hexdigest()</code></div>
<div class="line number13 index12 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code>&nbsp;</div>
<div class="line number14 index13 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python keyword">if</code>&nbsp;<code class="python plain">tmpstr&nbsp;</code><code class="python keyword">=</code><code class="python keyword">=</code>&nbsp;<code class="python plain">signature:</code></div>
<div class="line number15 index14 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python keyword">return</code>&nbsp;<code class="python plain">echoStr</code></div>
<div class="line number16 index15 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python keyword">else</code><code class="python plain">:&nbsp;</code></div>
<div class="line number17 index16 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python keyword">return</code>&nbsp;<code class="python color1">None</code></div>
</div>
</td>
</tr>
</tbody>
</table>
</div>
<p style="margin-top:0px;margin-bottom:0px;font-family:'Times New Roman';">很明显15行变了。浏览器和服务器之间，并不是简单的传递数据，还有解析包的过程，服务器返回一个http类型的文档，浏览器要进行协议解析，读取头部等东西，进而解析出整个文档。这就是为什么需要在返回的时候包装成HttpResponse，否则浏览器读不懂，django就报错说：返回的不是一个httpresponse类型的对象。我曾经参考《linux&nbsp;C&nbsp;编程指南》写过一个简单的服务器程序，服务器程序，发送了固定的头部，然后对各种不同类型的返回打印不同的文档，例如404，503等等，而对于正常情况，则读取一个html文件予以返回。协议与就是相互商量好的约定，故而协议一般都约定了要以什么开头，或者按照协议里写的东西来解析。</p>
<p style="margin-top:0px;margin-bottom:0px;font-family:'Times New Roman';"></p>
<p style="margin-top:0px;margin-bottom:0px;font-family:'Times New Roman';">下面是parse_request_xml函数，用来解析请求，该请求来自微信服务器，包含了一个xml结构，使用的是POST方法，待会我们就用个工具来测试一下怎么模拟POST请求，而不使用微信发送（微信发送需要经过微信服务器，而且我们不知道错在哪里）。</p>
<div id="highlighter_242112" class="syntaxhighlighter python" highlighter="brush:python;toolbar:false;" style="font-family:'Times New Roman';"><table border="0" cellpadding="0" cellspacing="0" style="clear:both;margin-bottom:10px;word-break:break-all;"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div>
<div class="line number2 index1 alt1">2</div>
<div class="line number3 index2 alt2">3</div>
<div class="line number4 index3 alt1">4</div>
<div class="line number5 index4 alt2">5</div>
<div class="line number6 index5 alt1">6</div>
<div class="line number7 index6 alt2">7</div>
</td>
<td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="python comments"># 解析请求,拆解到一个字典里&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code></div>
<div class="line number2 index1 alt1"><code class="python keyword">def</code>&nbsp;<code class="python plain">parse_request_xml(rootElem):</code></div>
<div class="line number3 index2 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">msg&nbsp;</code><code class="python keyword">=</code>&nbsp;<code class="python plain">{}</code></div>
<div class="line number4 index3 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python keyword">if</code>&nbsp;<code class="python plain">rootElem.tag&nbsp;</code><code class="python keyword">=</code><code class="python keyword">=</code>&nbsp;<code class="python string">'xml'</code><code class="python plain">:</code></div>
<div class="line number5 index4 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python keyword">for</code>&nbsp;<code class="python plain">child&nbsp;</code><code class="python keyword">in</code>&nbsp;<code class="python plain">rootElem:</code></div>
<div class="line number6 index5 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">msg[child.tag]&nbsp;</code><code class="python keyword">=</code>&nbsp;<code class="python plain">smart_str(child.text)&nbsp;&nbsp;</code><code class="python comments"># 获得内容&nbsp;</code></div>
<div class="line number7 index6 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python keyword">return</code>&nbsp;<code class="python plain">msg</code></div>
</div>
</td>
</tr>
</tbody>
</table>
</div>
<p style="margin-top:0px;margin-bottom:0px;font-family:'Times New Roman';">很明显，对于一个xml结构（其实是一个字符串），进行解析，就需要用到它的tag，来区分到底是什么内容，以及获取对应tag的内容，放到python我们程序中的一个字典结构里。</p>
<p style="margin-top:0px;margin-bottom:0px;font-family:'Times New Roman';"></p>
<p style="margin-top:0px;margin-bottom:0px;font-family:'Times New Roman';">下面是response_msg函数：</p>
<div id="highlighter_564878" class="syntaxhighlighter python" highlighter="brush:python;toolbar:false;" style="font-family:'Times New Roman';"><table border="0" cellpadding="0" cellspacing="0" style="clear:both;margin-bottom:10px;word-break:break-all;"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div>
<div class="line number2 index1 alt1">2</div>
<div class="line number3 index2 alt2">3</div>
<div class="line number4 index3 alt1">4</div>
<div class="line number5 index4 alt2">5</div>
<div class="line number6 index5 alt1">6</div>
<div class="line number7 index6 alt2">7</div>
<div class="line number8 index7 alt1">8</div>
<div class="line number9 index8 alt2">9</div>
<div class="line number10 index9 alt1">10</div>
<div class="line number11 index10 alt2">11</div>
<div class="line number12 index11 alt1">12</div>
<div class="line number13 index12 alt2">13</div>
<div class="line number14 index13 alt1">14</div>
<div class="line number15 index14 alt2">15</div>
<div class="line number16 index15 alt1">16</div>
<div class="line number17 index16 alt2">17</div>
</td>
<td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="python keyword">def</code>&nbsp;<code class="python plain">response_msg(request):</code></div>
<div class="line number2 index1 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python comments"># 从request中获取输入文本</code></div>
<div class="line number3 index2 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">rawStr&nbsp;</code><code class="python keyword">=</code>&nbsp;<code class="python plain">smart_str(request.raw_post_data)</code></div>
<div class="line number4 index3 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python comments"># 将文本进行解析,得到请求的数据</code></div>
<div class="line number5 index4 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">msg&nbsp;</code><code class="python keyword">=</code>&nbsp;<code class="python plain">parse_request_xml(ET.fromstring(rawStr))</code></div>
<div class="line number6 index5 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python comments"># 根据请求消息来处理内容返回</code></div>
<div class="line number7 index6 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">query_str&nbsp;</code><code class="python keyword">=</code>&nbsp;<code class="python plain">msg.get(</code><code class="python string">"Content"</code><code class="python plain">)</code></div>
<div class="line number8 index7 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python comments"># query_str = "hello"</code></div>
<div class="line number9 index8 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">response_msg&nbsp;</code><code class="python keyword">=</code>&nbsp;<code class="python plain">""</code></div>
<div class="line number10 index9 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python comments"># 使用简单的处理逻辑，有待扩展</code></div>
<div class="line number11 index10 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python keyword">if</code>&nbsp;<code class="python plain">query_str&nbsp;</code><code class="python keyword">=</code><code class="python keyword">=</code>&nbsp;<code class="python string">"hello"</code><code class="python plain">:</code></div>
<div class="line number12 index11 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">response_msg&nbsp;</code><code class="python keyword">=</code>&nbsp;<code class="python string">"hello to you too"</code></div>
<div class="line number13 index12 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python keyword">else</code><code class="python plain">:</code></div>
<div class="line number14 index13 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">response_msg&nbsp;</code><code class="python keyword">=</code>&nbsp;<code class="python string">"how are you, unkown"</code></div>
<div class="line number15 index14 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python comments"># 返回消息</code></div>
<div class="line number16 index15 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python comments"># 包括post_msg，和对应的 response_msg</code></div>
<div class="line number17 index16 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python keyword">return</code>&nbsp;<code class="python plain">pack_text_xml(msg, response_msg);</code></div>
</div>
</td>
</tr>
</tbody>
</table>
</div>
<p style="margin-top:0px;margin-bottom:0px;font-family:'Times New Roman';">消息回应，这里的逻辑很简单，对于hello，就返回一个hello&nbsp;to&nbsp;you&nbsp;too,&nbsp;其他则返回&nbsp;how&nbsp;are&nbsp;you&nbsp;,&nbsp;unkown。将来用户如果发来“第一篇”等请求，我们将返回完整的图文消息。这部分是有待开发的。</p>
<p style="margin-top:0px;margin-bottom:0px;font-family:'Times New Roman';"></p>
<p style="margin-top:0px;margin-bottom:0px;font-family:'Times New Roman';">上面的回应函数用到了打包返回消息成xml这样的功能，pack_text_xml函数如下：</p>
<div id="highlighter_790104" class="syntaxhighlighter python" highlighter="brush:python;toolbar:false;" style="font-family:'Times New Roman';"><table border="0" cellpadding="0" cellspacing="0" style="clear:both;margin-bottom:10px;word-break:break-all;"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div>
<div class="line number2 index1 alt1">2</div>
<div class="line number3 index2 alt2">3</div>
<div class="line number4 index3 alt1">4</div>
<div class="line number5 index4 alt2">5</div>
<div class="line number6 index5 alt1">6</div>
<div class="line number7 index6 alt2">7</div>
<div class="line number8 index7 alt1">8</div>
<div class="line number9 index8 alt2">9</div>
<div class="line number10 index9 alt1">10</div>
<div class="line number11 index10 alt2">11</div>
<div class="line number12 index11 alt1">12</div>
<div class="line number13 index12 alt2">13</div>
<div class="line number14 index13 alt1">14</div>
<div class="line number15 index14 alt2">15</div>
</td>
<td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="python comments"># 打包消息xml，作为返回&nbsp;</code></div>
<div class="line number2 index1 alt1"><code class="python keyword">def</code>&nbsp;<code class="python plain">pack_text_xml(post_msg,response_msg):</code></div>
<div class="line number3 index2 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python comments"># f = post_msg['FromUserName']</code></div>
<div class="line number4 index3 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python comments"># t = post_msg['FromUserName']</code></div>
<div class="line number5 index4 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">text_tpl&nbsp;</code><code class="python keyword">=</code>&nbsp;<code class="python comments">'''&lt;xml&gt;</code></div>
<div class="line number6 index5 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python comments">&lt;ToUserName&gt;&lt;![CDATA[%s]]&gt;&lt;/ToUserName&gt;</code></div>
<div class="line number7 index6 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python comments">&lt;FromUserName&gt;&lt;![CDATA[%s]]&gt;&lt;/FromUserName&gt;</code></div>
<div class="line number8 index7 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python comments">&lt;CreateTime&gt;%s&lt;/CreateTime&gt;</code></div>
<div class="line number9 index8 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python comments">&lt;MsgType&gt;&lt;![CDATA[%s]]&gt;&lt;/MsgType&gt;</code></div>
<div class="line number10 index9 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python comments">&lt;Content&gt;&lt;![CDATA[%s]]&gt;&lt;/Content&gt;</code></div>
<div class="line number11 index10 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python comments">&lt;FuncFlag&gt;0&lt;/FuncFlag&gt;</code></div>
<div class="line number12 index11 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python comments">&lt;/xml&gt;'''</code></div>
<div class="line number13 index12 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">text_tpl&nbsp;</code><code class="python keyword">=</code>&nbsp;<code class="python plain">text_tpl&nbsp;</code><code class="python keyword">%</code>&nbsp;<code class="python plain">(post_msg[</code><code class="python string">'FromUserName'</code><code class="python plain">],post_msg[</code><code class="python string">'ToUserName'</code><code class="python plain">],</code><code class="python functions">str</code><code class="python plain">(</code><code class="python functions">int</code><code class="python plain">(time.time())),</code><code class="python string">'text'</code><code class="python plain">,response_msg)</code></div>
<div class="line number14 index13 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python comments"># 调换发送者和接收者，然后填入需要返回的信息到xml中</code></div>
<div class="line number15 index14 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python keyword">return</code>&nbsp;<code class="python plain">text_tpl</code></div>
</div>
</td>
</tr>
</tbody>
</table>
</div>
<p style="margin-top:0px;margin-bottom:0px;font-family:'Times New Roman';">可以看到text_tpl其实就是微信API内容的一个——返回text，就是聊天记录一样的文本。对于其它内容，有其他内容的模板，可以到微信公众帐号API察看。这里需要说明的是xml结构里面要填参数的地方，都有一个占位符号%s，表示的是一个字符串。然后对于模板，填如我们的参数。如第12行所示。</p>
<h3 style="background-color:#000000;color:#ffffff;padding:10px;font-family:'Times New Roman';">poster测试</h3>
<p style="margin-top:0px;margin-bottom:0px;font-family:'Times New Roman';">&nbsp;&nbsp;好了，我们可以开始测试了。我google了一下，有人说使用firefox的poster插件，非常好用。于是我就在firefox下装了一个，来模拟各种各样不同的http请求。首先，要有一个firefox浏览器，ubuntu现在是自带了，无需安装，如果没有可以去官网下载。然后安装poster，点<a href="https://addons.mozilla.org/zh-cn/firefox/addon/poster/" target="_blank" data_ue_src="https://addons.mozilla.org/zh-cn/firefox/addon/poster/">这里</a>，找到了poster插件，在firefox安装就行了。好了，我们可以模拟微信服务器发送我们的消息转发了，如下：</p>
<p style="margin-top:0px;margin-bottom:0px;font-family:'Times New Roman';"><img src="http://www.wiz.cn/unzip/3eb90c0e-f584-11e0-a072-00237def97cc/27231758-ce5a-a853-c1b3-a2a1022fd49f.5886/index_files/8e8315b488a6fdb9c65b6f500d40fc4e.png" data_ue_src="http://www.wiz.cn/unzip/3eb90c0e-f584-11e0-a072-00237def97cc/27231758-ce5a-a853-c1b3-a2a1022fd49f.5886/index_files/8e8315b488a6fdb9c65b6f500d40fc4e.png"></p>
<p style="margin-top:0px;margin-bottom:0px;font-family:'Times New Roman';">使用时，填入post请求时发送的xml,还有你的服务器的url，例如我的是:&nbsp;<a href="http://scnuwriter.sinaapp.com/" target="_blank" data_ue_src="http://scnuwriter.sinaapp.com">http://scnuwriter.sinaapp.com</a>&nbsp;然后点post，就可以看到下面的画面：</p>
<p style="margin-top:0px;margin-bottom:0px;font-family:'Times New Roman';"><img src="http://www.wiz.cn/unzip/3eb90c0e-f584-11e0-a072-00237def97cc/27231758-ce5a-a853-c1b3-a2a1022fd49f.5886/index_files/9e9f707207e852913050ad5c32939048.png" data_ue_src="http://www.wiz.cn/unzip/3eb90c0e-f584-11e0-a072-00237def97cc/27231758-ce5a-a853-c1b3-a2a1022fd49f.5886/index_files/9e9f707207e852913050ad5c32939048.png"></p>
<p style="margin-top:0px;margin-bottom:0px;font-family:'Times New Roman';">可以看到我们的服务器返回了&nbsp;hello&nbsp;to&nbsp;you&nbsp;too,这是和我们的程序相符合的。但是可能你得到的是一个403fobidden。我google了一下，stack&nbsp;overflow里面说，那可能是因为我们没有启用跨站请求，以防止攻击，具体参考python的csrf文档。后来我修改了settings.py文件里面的middleware配置：</p>
<div id="highlighter_791285" class="syntaxhighlighter python" highlighter="brush:python;toolbar:false;" style="font-family:'Times New Roman';"><table border="0" cellpadding="0" cellspacing="0" style="clear:both;margin-bottom:10px;word-break:break-all;"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2" style="height:20px;">1</div>
<div class="line number2 index1 alt1" style="height:20px;">2</div>
<div class="line number3 index2 alt2" style="height:20px;">3</div>
<div class="line number4 index3 alt1" style="height:20px;">4</div>
<div class="line number5 index4 alt2" style="height:20px;">5</div>
<div class="line number6 index5 alt1" style="height:20px;">6</div>
<div class="line number7 index6 alt2" style="height:20px;">7</div>
<div class="line number8 index7 alt1" style="height:20px;">8</div>
<div class="line number9 index8 alt2" style="height:20px;">9</div>
<div class="line number10 index9 alt1" style="height:20px;">10</div>
<div class="line number11 index10 alt2" style="height:20px;">11</div>
<div class="line number12 index11 alt1" style="height:20px;">12</div>
</td>
<td class="code"><div class="container"><div class="line number1 index0 alt2" style="height:20px;"><code class="python plain">MIDDLEWARE_CLASSES&nbsp;</code><code class="python keyword">=</code>&nbsp;<code class="python plain">(</code></div>
<div class="line number2 index1 alt1" style="height:20px;"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python string">'django.middleware.common.CommonMiddleware'</code><code class="python plain">,</code></div>
<div class="line number3 index2 alt2" style="height:20px;"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python string">'django.contrib.sessions.middleware.SessionMiddleware'</code><code class="python plain">,</code></div>
<div class="line number4 index3 alt1" style="height:20px;"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python string">'django.middleware.csrf.CsrfViewMiddleware'</code><code class="python plain">,</code></div>
<div class="line number5 index4 alt2" style="height:20px;"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python string">'django.contrib.auth.middleware.AuthenticationMiddleware'</code><code class="python plain">,</code></div>
<div class="line number6 index5 alt1" style="height:20px;"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python string">'django.contrib.messages.middleware.MessageMiddleware'</code><code class="python plain">,</code></div>
<div class="line number7 index6 alt2" style="height:20px;"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python comments"># for post:</code></div>
<div class="line number8 index7 alt1" style="height:20px;"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python comments">#'django.middleware.csrf.CsrfResponseMiddleware',&nbsp;&nbsp;&nbsp;&nbsp;</code></div>
<div class="line number9 index8 alt2" style="height:20px;"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code>&nbsp;</div>
<div class="line number10 index9 alt1" style="height:20px;"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python comments"># Uncomment the next line for simple clickjacking protection:</code></div>
<div class="line number11 index10 alt2" style="height:20px;"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python comments">#'django.middleware.clickjacking.XFrameOptionsMiddleware',</code></div>
<div class="line number12 index11 alt1" style="height:20px;"><code class="python plain">)</code></div>
</div>
</td>
</tr>
</tbody>
</table>
</div>
<p style="margin-top:0px;margin-bottom:0px;font-family:'Times New Roman';">很奇怪，我去掉第8行CsrfResponseMiddleware之后，服务器就出错了。故而我注释了它，然后在views.py的最前面的函数前面加上一个：@csrf_exempt&nbsp;&nbsp;。结果就行了，得到上面截图的内容。要深入了解这是为什么，还需要了解web的更多信息，还有django的官方文档，bibo也要好好充电了，知其然，不知其所以然，不可谓为知也。</p>
<p style="margin-top:0px;margin-bottom:0px;font-family:'Times New Roman';"></p>
<h3 style="background-color:#000000;color:#ffffff;padding:10px;font-family:'Times New Roman';">最后</h3>
<p style="margin-top:0px;margin-bottom:0px;font-family:'Times New Roman';">好吧，用svn上传你的成果到服务器上吧，用手机来测试。一般用post得到了正确回应都不会有错的。bibo在自己的手机微信上面发送了一个"hello"，真的收到了一个"hello&nbsp;to&nbsp;you&nbsp;too"。第一次尝试微信编程，居然成功了！yeah。而且还学会了一个工具poster。</p>
<p style="margin-top:0px;margin-bottom:0px;font-family:'Times New Roman';"></p>
<p style="margin-top:0px;margin-bottom:0px;font-family:'Times New Roman';">by&nbsp;bibodeng&nbsp;2013-04-19&nbsp;&nbsp;&nbsp;士别三日，当刮目相看</p>
<p style="margin-top:0px;margin-bottom:0px;font-family:'Times New Roman';"></p>
<p style="margin-top:0px;margin-bottom:0px;font-family:'Times New Roman';">scnuwriter示例下载链接：<a href="http://vdisk.weibo.com/s/y9wJz" data_ue_src="http://vdisk.weibo.com/s/y9wJz" target="_blank" rel="noopener">http://vdisk.weibo.com/s/y9wJz</a>&nbsp; 主要看views.py</p>
<p style="margin-top:0px;margin-bottom:0px;font-family:'Times New Roman';"></p>
<p style="margin-top:0px;margin-bottom:0px;font-family:'Times New Roman';"></p>
<p style="margin-top:0px;margin-bottom:0px;font-family:'Times New Roman';"></p>
<p style="margin-top:0px;margin-bottom:0px;font-family:'Times New Roman';"></p>
<p style="margin-top:0px;margin-bottom:0px;font-family:'Times New Roman';"></p>
<p style="margin-top:0px;margin-bottom:0px;font-family:'Times New Roman';"></p>
<p style="margin-top:0px;margin-bottom:0px;font-family:'Times New Roman';"></p>
<p style="margin-top:0px;margin-bottom:0px;font-family:'Times New Roman';"></p>
<p style="margin-top:0px;margin-bottom:0px;font-family:'Times New Roman';"></p>
<p style="margin-top:0px;margin-bottom:0px;font-family:'Times New Roman';"></p>
<p style="margin-top:0px;margin-bottom:0px;font-family:'Times New Roman';"></p>
<p style="margin-top:0px;margin-bottom:0px;font-family:'Times New Roman';"></p>
<p style="margin-top:0px;margin-bottom:0px;font-family:'Times New Roman';"></p>
<p style="margin-top:0px;margin-bottom:0px;font-family:'Times New Roman';"></p>
</div>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2013/04/18/第一次面试/" itemprop="url">
                  第一次面试
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">发表于</span>
            <time itemprop="dateCreated" datetime="2013-04-18T20:07:17+08:00" content="2013-04-18">
              2013-04-18
            </time>
          </span>

          

          
            
          

          
	
          
          
             <span id="/2013/04/18/第一次面试/" class="leancloud_visitors" data-flag-title="第一次面试">
               &nbsp; | &nbsp;
               <span class="post-meta-item-icon">
                 <i class="fa fa-eye"></i>
               </span>
               <span class="post-meta-item-text">阅读次数 </span>
               <span class="leancloud-visitors-count"></span>
              </span>
          

          
        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            
<div class="art_content" style="font-size:15px;letter-spacing:1px;line-height:1.3em;"><h3 style="background-color:#000000;color:#ffffff;padding:10px;font-family:'Times New Roman';">考验你</h3>
<p style="margin-top:0px;margin-bottom:0px;font-family:'Times New Roman';">笔试的时候，觉得自己很可能被刷了。等到大多数人都有拿到了面试通知的时候，我发现我没有。然后心里有点焦急，然后和师兄聊了，说后悔搞了很多其他的锦上添花（项目和其他自学技术）而不是雪中送炭的东西（基础知识）。然后慢慢安下心来，做《南苑随笔》的微信app。然后，就意外地收到了通知，那就去试试吧。@daoluan&nbsp;兄没有收到，这不科学，肯定是上帝在考验我们。在等待中我这样写道：</p>
<blockquote style="background-color:#ccff99;border-top-left-radius:5px;border-top-right-radius:5px;border-bottom-right-radius:5px;border-bottom-left-radius:5px;font-family:'Times New Roman';"><p style="margin-top:0px;margin-bottom:0px;">即使偶然失败了，也不要灰心，因为这是老天爷在考验我，我还有些地方不够好，所以他叫我回去好好练，下次再来。</p>
</blockquote>
<p style="margin-top:0px;margin-bottom:0px;font-family:'Times New Roman';"></p>
<h3 style="background-color:#000000;color:#ffffff;padding:10px;font-family:'Times New Roman';">准备</h3>
<p style="margin-top:0px;margin-bottom:0px;font-family:'Times New Roman';">为了有个良好的表现，必须在物质上和精神上有准备。就思想上，我让自己淡定一点，但是面试技巧和技术上我做了如下准备：</p>
<h4 style="font-family:'Times New Roman';">1&nbsp;&nbsp;准备一身精神的行头，轻装上阵</h4>
<p style="margin-top:0px;margin-bottom:0px;font-family:'Times New Roman';">我借了一条皮带，穿上我只穿过两次的衬衫，觉得今天算整洁了，足以表达对面试官的尊重。</p>
<h4 style="font-family:'Times New Roman';">2&nbsp;&nbsp;准备好闹钟提醒</h4>
<p style="margin-top:0px;margin-bottom:0px;font-family:'Times New Roman';">由于在坑爹的南海，故而需要很早就开始搭车到广州，然后搭地铁到面试地点。十点半左右开始，那么我需要6点半起床出发，经过2个钟头的275路车程，再经过1个多钟头的地铁，10点多应该就能到达了。保险起见，还是6点就开拔吧，这样好歹都能在车上睡一下。</p>
<h4 style="font-family:'Times New Roman';">3&nbsp;&nbsp;个人简介和礼仪</h4>
<p style="margin-top:0px;margin-bottom:0px;font-family:'Times New Roman';">准备好个人简介发言，对面试官有里面。面试官您好，我是来自华南师范大学的bibodeng，我热爱编程，系统学习过C/C++&nbsp;，操作系统，算法与数据结构等课程，在校成绩还行，且积极参加科研立项，自学python与php，有web开发经验，有自己的独立博客。欢迎面试官对我提问。</p>
<h4 style="font-family:'Times New Roman';">4&nbsp;&nbsp;准备应对简历上的问题</h4>
<p style="margin-top:0px;margin-bottom:0px;font-family:'Times New Roman';">对于我熟悉的技术，以及基础的知识，我要准备好应对面试官的提问。例如，面试官如果问关于linux的知识，我肯定要回答了解一点，如果他深入地询问那些管理命令。同时跟他聊聊关于自己动手解决问题，例如编写&nbsp;语音报时脚本，编写博客的css模版（一次编写，处处应用，所以你现在看到的颜色搭配的标题和blockquote都是来自于一个短短的css脚本），运用python解决euler的趣题，难题。</p>
<h4 style="font-family:'Times New Roman';">5&nbsp;&nbsp;复习基础的算法——排序，二分查找，深度遍历，广度遍历等</h4>
<p style="margin-top:0px;margin-bottom:0px;font-family:'Times New Roman';">对于排序，最有可能考的是冒泡和快速排序，快速排序《编程珠玑》上面有，所以我需要平静下来，循着思路来写。遇到有思路的时候，就跟面试官互动一下，要点提示。如果不小心沉默了一下，有间隔，不妨多沉默一下，反而会让人觉得你沉着冷静，且能够深思熟虑，办事靠谱。这些都是从别人的面经上得来的经验方法。</p>
<p style="margin-top:0px;margin-bottom:0px;font-family:'Times New Roman';"></p>
<p style="margin-top:0px;margin-bottom:0px;font-family:'Times New Roman';">好了，有了这些准备，就拜托给我一个好运气吧。。</p>
<p style="margin-top:0px;margin-bottom:0px;font-family:'Times New Roman';"></p>
<h3 style="background-color:#000000;color:#ffffff;padding:10px;font-family:'Times New Roman';">面试ing</h3>
<p style="margin-top:0px;margin-bottom:0px;font-family:'Times New Roman';">&nbsp;&nbsp;&nbsp;&nbsp;终于到了面试了，从学校早上6点多搭车到了面试的酒店，足足用了3个多钟。稍微有点紧张，走进去，考官叫我坐下，然后等他问我，简单做了个自我介绍。面试官就开始问各种问题了，包括web开发的一些很基础的原理，可惜我说的都很不明白，往往没有戳中要点。譬如ajax的作用的原理是什么，我答不出来，于是他给我提示，说是能改变DOM的内容，然后我恍然大悟。就是那么坑爹，我原先准备好的数据结构和算法，居然一个都不问，感觉最后面试官认为我很水，不适合在这个岗位工作。啊！！怎么可以这样，我继续很淡定地和他谈对于学习要有深入性的观点，就此双方交换了意见，结果很明白，我太水了~&nbsp;不过我很希望面试官能够再给我一点机会，因为他真的很nice，貌似也很委婉了表达了他们追求卓越的精神。而且给我看了笔试的成绩，惨不忍睹。好啦，面试的过程就不细讲了，问了下其他的同学，都说考了数据结构等。这次的经验教训就是“仅仅是有东西是不行的，而且要有深入的东西”。坐车回来的路上，我一直在想，面试怎么会这么刷人的，40选1都有，看来大家要视自己的实力来选择部门，实力不够雄厚的就报技术含量低的，像weixin这样的牛逼团队，需要的都是牛人。看来得再修炼半年，都说“士别三日当刮目相看”，有时侯上帝降给我失败，是认为我不够好，需要继续修炼。</p>
<p style="margin-top:0px;margin-bottom:0px;font-family:'Times New Roman';"></p>
<p style="margin-top:0px;margin-bottom:0px;font-family:'Times New Roman';">&nbsp;&nbsp;&nbsp;&nbsp;战略调整：对于自己感兴趣的方向，大公司要求的是你“基础扎实，钻研深厚”。今天下午跟华师毕业的在华工攻读研究生的@嘉其&nbsp;师兄聊了一些近况，和当年他们的笔试面试情况。他说，当年，进了笔试的就只有4个，而面试又刷了2个，他是其中之一。看来技术面还真的会很惨烈啊，问你一些深入的知识就挂不住了。所以，底气是由实力决定的。牛逼程度够高了，他就录了你。又应了之前说的一句话：“有其能者当其事”。</p>
<p style="margin-top:0px;margin-bottom:0px;font-family:'Times New Roman';"></p>
<h3 style="background-color:#000000;color:#ffffff;padding:10px;font-family:'Times New Roman';">小结</h3>
<p style="margin-top:0px;margin-bottom:0px;font-family:'Times New Roman';">&nbsp;&nbsp;&nbsp;&nbsp;虽然能过笔试，但是面试还是底气不够。在bibo写这篇的时候结果还没有出来，所以要等通知。TenC’这样的公司，如果招的人少，要进去是很难的，除非真的有点料。不过，我听说华工的同学都是把它当作保底的offer，诧异中。。当然这是不是事实，还有待考证。这次最大的收获就是，为了应对你的面试，你绝对需要找出你最熟悉的部分来对答，还要真正在学习中，有自己的专攻，优秀是不够的，要做到卓越，exordinary.</p>
<p style="margin-top:0px;margin-bottom:0px;font-family:'Times New Roman';"></p>
<p style="margin-top:0px;margin-bottom:0px;font-family:'Times New Roman';">by&nbsp;bibodeng&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2013-04-18</p>
<p style="margin-top:0px;margin-bottom:0px;font-family:'Times New Roman';"></p>
<p style="margin-top:0px;margin-bottom:0px;font-family:'Times New Roman';"></p>
<p style="margin-top:0px;margin-bottom:0px;font-family:'Times New Roman';"></p>
<p style="margin-top:0px;margin-bottom:0px;font-family:'Times New Roman';"></p>
<p style="margin-top:0px;margin-bottom:0px;font-family:'Times New Roman';"></p>
<p style="margin-top:0px;margin-bottom:0px;font-family:'Times New Roman';"></p>
<p style="margin-top:0px;margin-bottom:0px;font-family:'Times New Roman';"></p>
<p style="margin-top:0px;margin-bottom:0px;font-family:'Times New Roman';"></p>
<p style="margin-top:0px;margin-bottom:0px;font-family:'Times New Roman';"></p>
<p style="margin-top:0px;margin-bottom:0px;font-family:'Times New Roman';"></p>
<p style="margin-top:0px;margin-bottom:0px;font-family:'Times New Roman';"></p>
<p style="margin-top:0px;margin-bottom:0px;font-family:'Times New Roman';"></p>
<p style="margin-top:0px;margin-bottom:0px;font-family:'Times New Roman';"></p>
<p style="margin-top:0px;margin-bottom:0px;font-family:'Times New Roman';"></p>
<p style="margin-top:0px;margin-bottom:0px;font-family:'Times New Roman';"></p>
<p style="margin-top:0px;margin-bottom:0px;font-family:'Times New Roman';"></p>
<p style="margin-top:0px;margin-bottom:0px;font-family:'Times New Roman';"></p>
<p style="margin-top:0px;margin-bottom:0px;font-family:'Times New Roman';"></p>
</div>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2013/04/16/C C++复仇记(上)/" itemprop="url">
                  C C++复仇记(上)
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">发表于</span>
            <time itemprop="dateCreated" datetime="2013-04-16T21:46:27+08:00" content="2013-04-16">
              2013-04-16
            </time>
          </span>

          

          
            
          

          
	
          
          
             <span id="/2013/04/16/C C++复仇记(上)/" class="leancloud_visitors" data-flag-title="C C++复仇记(上)">
               &nbsp; | &nbsp;
               <span class="post-meta-item-icon">
                 <i class="fa fa-eye"></i>
               </span>
               <span class="post-meta-item-text">阅读次数 </span>
               <span class="leancloud-visitors-count"></span>
              </span>
          

          
        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            
<div class="art_content" style="font-size:15px;letter-spacing:1px;line-height:1.3em;"><p style="margin-top:0px;margin-bottom:0px;font-family:'Times New Roman';">由于前几天的笔试很大程度上刺激了我，让我越发感觉到自己的C/C++基础十分地薄弱，故而想要找几本经典的C/C++书本来深入了解一下C/C++语言特性，以及其中需要注意的问题。</p>
<p style="margin-top:0px;margin-bottom:0px;font-family:'Times New Roman';">google了一下C语言经典著作，得到了我想要的结果：</p>
<blockquote style="background-color:#ccff99;border-top-left-radius:5px;border-top-right-radius:5px;border-bottom-right-radius:5px;border-bottom-left-radius:5px;font-family:'Times New Roman';"><p style="margin-top:0px;margin-bottom:0px;">《C专家编程》</p>
<p style="margin-top:0px;margin-bottom:0px;">《C语言详解》</p>
<p style="margin-top:0px;margin-bottom:0px;">《C语言核心技术》</p>
<p style="margin-top:0px;margin-bottom:0px;">《C陷阱与缺陷》</p>
<p style="margin-top:0px;margin-bottom:0px;">《C和指针》</p>
</blockquote>
<p style="margin-top:0px;margin-bottom:0px;font-family:'Times New Roman';">&nbsp;&nbsp;详细请到<a href="http://www.360doc.com/content/12/0331/06/9452699_199493153.shtml" target="_blank" data_ue_src="http://www.360doc.com/content/12/0331/06/9452699_199493153.shtml">C经典著作</a>书单察看介绍。</p>
<p style="margin-top:0px;margin-bottom:0px;font-family:'Times New Roman';">正是我想要补的，之前学习C语言，只是泛泛地学习了一些语言特性，然后编写了若干行的代码,知道了怎么使用指针，数组，结构体，以及用它编写二叉树，线性表等数据结构，还有实现了一遍大部分排序算法。</p>
<h3 style="background-color:#000000;color:#ffffff;padding:10px;font-family:'Times New Roman';">语言细节&nbsp;AND&nbsp;正确的程序</h3>
<p style="margin-top:0px;margin-bottom:0px;font-family:'Times New Roman';">常常遇到这样的情况，程序写到一半，忘了这个代码的语言细节是什么的，例如++自增的使用，而这往往涉及到程序的正确性。有经验的程序员往往会发现i++和++i在很多情况下有很大不同，一时的麻痹或者粗心，都有可能造成重大的错误。记得之前有一个这样的故事：</p>
<p style="margin-top:0px;margin-bottom:0px;font-family:'Times New Roman';">美国宇航局发射航天飞机，但是因为一个程序员将“；”写成了“，”&nbsp;，最后造成了飞机失事。据说这是最昂贵的错误。</p>
<p style="margin-top:0px;margin-bottom:0px;font-family:'Times New Roman';"></p>
<p style="margin-top:0px;margin-bottom:0px;font-family:'Times New Roman';">代码是人编写的，难免会有错误，但是很多错误都是我们不清楚语言细节，或者某个语言的陷阱，从而失足跌倒。现实生活中很多代码都有错误，而黑客总是能够利用各种程序中的缺陷和漏洞，攻破我们的系统，拿走我们的数据和金钱。（我想起了《鹿鼎记》里面的，我们的财宝和女人，哈哈）。所以要写可靠的代码，必须要懂得一些常用的语言细节和规避陷阱的方法。</p>
<h3 style="background-color:#000000;color:#ffffff;padding:10px;font-family:'Times New Roman';">具体的问题</h3>
<p style="margin-top:0px;margin-bottom:0px;font-family:'Times New Roman';">我们编程的时候往往运行出结果就ok了，抛下程序去玩了。这是很不正确的学习方法，正确的学习方法应该深入理解程序在计算机程序在编译和运行时做了什么，故而多跟踪调试程序是有好处的。看看每一步都发生了什么，察看内存中的数据起了什么变化。</p>
<h4 style="font-family:'Times New Roman';">关于高级语言的内存管理</h4>
<p style="margin-top:0px;margin-bottom:0px;font-family:'Times New Roman';"><a href="http://www.cnblogs.com/chenleiustc/archive/2011/04/08/2009994.html" target="_blank" data_ue_src="http://www.cnblogs.com/chenleiustc/archive/2011/04/08/2009994.html">这里</a>有一篇关于内存管理的很好的说明了哪些数据是存储在什么区的。学习过汇编语言的我们，很容易就想起来我们的程序包括一些段：数据段，代码段，堆栈段。那么在高级语言中，这些数据又是怎样存储的呢？如下：</p>
<blockquote style="background-color:#ccff99;border-top-left-radius:5px;border-top-right-radius:5px;border-bottom-right-radius:5px;border-bottom-left-radius:5px;font-family:'Times New Roman';"><p style="margin-top:0px;margin-bottom:0px;">栈stack：&nbsp;存放局部变量，栈表示的是一种后进先出，表达了我程序调用的顺序，故而栈里面存放的是我们的函数中的局部变量，包括变量，指针，参数等等。栈内数据是共享的，回收工作是由内存管理来做的。</p>
<p style="margin-top:0px;margin-bottom:0px;"></p>
<p style="margin-top:0px;margin-bottom:0px;">堆heap：&nbsp;说白了就是程序申请的内存区，这里一块，那里一块，堆是受到保护的，不能互相访问。而回收的时候，我们要收回指向他们的指针，然后GC（gabage&nbsp;collection）来处理。一般malloc，或者是new的对象都是存储在堆里面的。</p>
<p style="margin-top:0px;margin-bottom:0px;"></p>
<p style="margin-top:0px;margin-bottom:0px;">（全局）静态区：&nbsp;全局区和静态区是是在一起的。包括全局变量global修饰的变量，static修饰的变量。有的时候，尽管没有static修饰，也算是静态区的。例如&nbsp;char&nbsp;*p&nbsp;=&nbsp;"hello";&nbsp;&nbsp;字符串"hello"就属于静态区的，因为没有专门为它分配空间，若是char&nbsp;c_arr[]&nbsp;=&nbsp;"hello";&nbsp;则有为字符串分配内存，故而是在栈区。</p>
<p style="margin-top:0px;margin-bottom:0px;"></p>
<p style="margin-top:0px;margin-bottom:0px;">文字常量区：常量字符串就是放在这里的。例如cout&lt;&lt;&nbsp;"hello&nbsp;world"&lt;&lt;endl;&nbsp;那么字符串hello&nbsp;world就存放在常量区。</p>
<p style="margin-top:0px;margin-bottom:0px;"></p>
<p style="margin-top:0px;margin-bottom:0px;">程序代码区：存放程序的二进制代码。</p>
</blockquote>
<p style="margin-top:0px;margin-bottom:0px;font-family:'Times New Roman';"></p>
<p style="margin-top:0px;margin-bottom:0px;font-family:'Times New Roman';">深刻理解程序和数据的存储，会更加明白如何编写节省资源和高效的程序，特别是分析由于存储问题带来的性能瓶颈问题，这在web和服务器编程上都很重要。</p>
<p style="margin-top:0px;margin-bottom:0px;font-family:'Times New Roman';"></p>
<h4 style="font-family:'Times New Roman';">关于C语言的sizeof</h4>
<p style="margin-top:0px;margin-bottom:0px;font-family:'Times New Roman';">我做了以下实验，对指针进行了sizeof关键字操作，以及指针的加法操作。</p>
<p style="margin-top:0px;margin-bottom:0px;font-family:'Times New Roman';"></p>
<table border="0" cellpadding="0" cellspacing="0" class=" noBorderTable ke-zeroborder" style="clear:both;margin-bottom:10px;word-break:break-all;color:#000000;font-family:'Times New Roman';font-size:15px;line-height:19.5px;"><tbody><tr><td class="gutter" style="border:1px dashed #dddddd !important;"><div class="line number1 index0 alt2">1</div>
<div class="line number2 index1 alt1">2</div>
<div class="line number3 index2 alt2">3</div>
<div class="line number4 index3 alt1">4</div>
<div class="line number5 index4 alt2">5</div>
<div class="line number6 index5 alt1">6</div>
<div class="line number7 index6 alt2">7</div>
</td>
<td class="code" style="border:1px dashed #dddddd !important;"><div class="container"><div class="line number1 index0 alt2"><code class="cpp comments">//&nbsp;关于数组的sizeof运算</code></div>
<div class="line number2 index1 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp color1 bold">int</code>&nbsp;<code class="cpp plain">a[100]={0,1};</code></div>
<div class="line number3 index2 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp functions bold">printf</code><code class="cpp plain">(</code><code class="cpp string">"%d\n"</code><code class="cpp plain">,</code><code class="cpp keyword bold">sizeof</code><code class="cpp plain">(a));&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp comments">//&nbsp;打印的是数组的很多信息，</code></div>
<div class="line number4 index3 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp functions bold">printf</code><code class="cpp plain">(</code><code class="cpp string">"%d\n"</code><code class="cpp plain">,</code><code class="cpp keyword bold">sizeof</code><code class="cpp plain">(a[100]));&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp comments">//</code></div>
<div class="line number5 index4 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp functions bold">printf</code><code class="cpp plain">(</code><code class="cpp string">"%d\n"</code><code class="cpp plain">,</code><code class="cpp keyword bold">sizeof</code><code class="cpp plain">(&amp;a));&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp comments">//&nbsp;是a的地址</code></div>
<div class="line number6 index5 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp functions bold">printf</code><code class="cpp plain">(</code><code class="cpp string">"%d\n"</code><code class="cpp plain">,</code><code class="cpp keyword bold">sizeof</code><code class="cpp plain">(&amp;a[0]));&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp comments">//&nbsp;</code></div>
<div class="line number7 index6 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">fun(a);&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp comments">//&nbsp;作为参数传递的数组，其实是个指针</code></div>
</div>
</td>
</tr>
</tbody>
</table>
<span style="font-family:'Times New Roman';">fun的定义如下：</span><p style="margin-top:0px;margin-bottom:0px;font-family:'Times New Roman';"></p>
<div id="highlighter_826335" class="syntaxhighlighter cpp" highlighter="brush:cpp;toolbar:false;" style="font-family:'Times New Roman';"><table border="0" cellpadding="0" cellspacing="0" class=" noBorderTable ke-zeroborder" style="clear:both;margin-bottom:10px;word-break:break-all;"><tbody><tr><td class="gutter" style="border:1px dashed #dddddd !important;"><div class="line number1 index0 alt2" style="height:20px;">1</div>
<div class="line number2 index1 alt1" style="height:20px;">2</div>
<div class="line number3 index2 alt2" style="height:20px;">3</div>
<div class="line number4 index3 alt1" style="height:20px;">4</div>
</td>
<td class="code" style="border:1px dashed #dddddd !important;"><div class="container"><div class="line number1 index0 alt2" style="height:20px;"><code class="cpp keyword bold">void</code>&nbsp;<code class="cpp plain">fun(</code><code class="cpp color1 bold">int</code>&nbsp;<code class="cpp plain">b[100])</code></div>
<div class="line number2 index1 alt1" style="height:20px;"><code class="cpp plain">{</code></div>
<div class="line number3 index2 alt2" style="height:20px;"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp functions bold">printf</code><code class="cpp plain">(</code><code class="cpp string">"%d\n"</code><code class="cpp plain">,</code><code class="cpp keyword bold">sizeof</code><code class="cpp plain">(b));</code></div>
<div class="line number4 index3 alt1" style="height:20px;"><code class="cpp plain">}</code></div>
</div>
</td>
</tr>
</tbody>
</table>
</div>
<p style="margin-top:0px;margin-bottom:0px;font-family:'Times New Roman';">我得到的结果是：</p>
<div id="highlighter_228111" class="syntaxhighlighter cpp" highlighter="brush:cpp;toolbar:false;" style="font-family:'Times New Roman';"><table border="0" cellpadding="0" cellspacing="0" class=" noBorderTable ke-zeroborder" style="clear:both;margin-bottom:10px;word-break:break-all;"><tbody><tr><td class="gutter" style="border:1px dashed #dddddd !important;"><div class="line number1 index0 alt2" style="height:20px;">1</div>
<div class="line number2 index1 alt1" style="height:20px;">2</div>
<div class="line number3 index2 alt2" style="height:20px;">3</div>
<div class="line number4 index3 alt1" style="height:20px;">4</div>
<div class="line number5 index4 alt2" style="height:20px;">5</div>
<div class="line number6 index5 alt1" style="height:20px;">6</div>
</td>
<td class="code" style="border:1px dashed #dddddd !important;"><div class="container"><div class="line number1 index0 alt2" style="height:20px;"><code class="cpp comments">//&nbsp;得到的结果是</code></div>
<div class="line number2 index1 alt1" style="height:20px;"><code class="cpp comments">//&nbsp;400 &nbsp;</code></div>
<div class="line number3 index2 alt2" style="height:20px;"><code class="cpp comments">//&nbsp;4</code></div>
<div class="line number4 index3 alt1" style="height:20px;"><code class="cpp comments">//&nbsp;4</code></div>
<div class="line number5 index4 alt2" style="height:20px;"><code class="cpp comments">//&nbsp;4</code></div>
<div class="line number6 index5 alt1" style="height:20px;"><code class="cpp comments">//&nbsp;4</code></div>
</div>
</td>
</tr>
</tbody>
</table>
</div>
<p style="margin-top:0px;margin-bottom:0px;font-family:'Times New Roman';">要是想在子函数中得到数组的大小，那么使用下面的fun:</p>
<div id="highlighter_670844" class="syntaxhighlighter cpp" highlighter="brush:cpp;toolbar:false;" style="font-family:'Times New Roman';"><table border="0" cellpadding="0" cellspacing="0" class=" noBorderTable ke-zeroborder" style="clear:both;margin-bottom:10px;word-break:break-all;"><tbody><tr><td class="gutter" style="border:1px dashed #dddddd !important;"><div class="line number1 index0 alt2" style="height:20px;">1</div>
<div class="line number2 index1 alt1" style="height:20px;">2</div>
<div class="line number3 index2 alt2" style="height:20px;">3</div>
<div class="line number4 index3 alt1" style="height:20px;">4</div>
</td>
<td class="code" style="border:1px dashed #dddddd !important;"><div class="container"><div class="line number1 index0 alt2" style="height:20px;"><code class="cpp keyword bold">void</code>&nbsp;<code class="cpp plain">fun(</code><code class="cpp color1 bold">int</code>&nbsp;<code class="cpp plain">(*a)[100])</code></div>
<div class="line number2 index1 alt1" style="height:20px;"><code class="cpp plain">{</code></div>
<div class="line number3 index2 alt2" style="height:20px;"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp functions bold">printf</code><code class="cpp plain">(</code><code class="cpp string">"%d\n"</code><code class="cpp plain">,</code><code class="cpp keyword bold">sizeof</code><code class="cpp plain">(*a));</code></div>
<div class="line number4 index3 alt1" style="height:20px;"><code class="cpp plain">}</code></div>
</div>
</td>
</tr>
</tbody>
</table>
</div>
<p style="margin-top:0px;margin-bottom:0px;font-family:'Times New Roman';">调用的时候是</p>
<div id="highlighter_36073" class="syntaxhighlighter cpp" highlighter="brush:cpp;toolbar:false;" style="font-family:'Times New Roman';"><table border="0" cellpadding="0" cellspacing="0" class=" noBorderTable ke-zeroborder" style="clear:both;margin-bottom:10px;word-break:break-all;"><tbody><tr><td class="gutter" style="border:1px dashed #dddddd !important;"><div class="line number1 index0 alt2" style="height:20px;">1</div>
</td>
<td class="code" style="border:1px dashed #dddddd !important;"><div class="container"><p style="margin-top:0px;margin-bottom:0px;"><code class="cpp plain">fun(&amp;a);</code></p>
</div>
</td>
</tr>
</tbody>
</table>
</div>
<p style="margin-top:0px;margin-bottom:0px;font-family:'Times New Roman';">故而能够得到预期的400。</p>
<p style="margin-top:0px;margin-bottom:0px;font-family:'Times New Roman';"></p>
<h4 style="font-family:'Times New Roman';">关于数据类型的溢出和转换</h4>
<p style="margin-top:0px;margin-bottom:0px;font-family:'Times New Roman';">各种数据类型的转换，某些情况下系统是能够自动类型转换的，如赋值，表达式，循环条件判断中。遵循的是从低精度变到高精度的原则。而从高精度强制转换到低精度，则需要损失一部分的数据，所以应该斟酌为之，特别是不确定转换结果的情况下。</p>
<p style="margin-top:0px;margin-bottom:0px;font-family:'Times New Roman';"></p>
<p style="margin-top:0px;margin-bottom:0px;font-family:'Times New Roman';">只要弄明白了数据类型在计算机里面怎么存储，就能够明白什么样的转换是行的，什么样的转换是不行的。整形数据在内存中，存储的都是补码。对于负数，补码是反码+1，而对正数补码就是本身的码。例如char类型的（默认是unsigned）可以表示[0,255]&nbsp;,如果是signed，那么就可以表示[-128,127],也就是说分了一半去表示负数。int同理，一般的程序中，不会有太多的类型转换，因为这潜在着不安全因素，例如if里面的表达式就是一个很好的例子。</p>
<p style="margin-top:0px;margin-bottom:0px;font-family:'Times New Roman';">对于bool型的，假如有个checked表示某个步骤是否通过检查，&nbsp;用if(checked)。</p>
<p style="margin-top:0px;margin-bottom:0px;font-family:'Times New Roman';">对于int型，直接if(&nbsp;0&nbsp;==&nbsp;num)&nbsp;比较</p>
<p style="margin-top:0px;margin-bottom:0px;font-family:'Times New Roman';">对于浮点型，用&nbsp;if&nbsp;(&nbsp;0-EP&lt;num&nbsp;&amp;&amp;&nbsp;num&nbsp;&gt;&nbsp;0+EP)&nbsp;来确定是否和0相等</p>
<p style="margin-top:0px;margin-bottom:0px;font-family:'Times New Roman';">所以，我们要用同样类型的去比较，C中可以while(a),&nbsp;a是一个int型，Java就比较严格，不允许将int转换为bool类型做判断。</p>
<h4 style="font-family:'Times New Roman';">关于运算符的优先级<br>
</h4>
<p style="margin-top:0px;margin-bottom:0px;font-family:'Times New Roman';">这个就要参考程序语言的手册了，我们自己写程序的时候，最保险的就是给各种表达式都加上括号，以避免意外的求值出现。同级的按结合顺序来判断。例如+，-，*，/&nbsp;,&nbsp;%是左结合；而对于！，=这样的，就属于右结合。有什么规律可循呢？所有的优先级中，只有三个优先级是从右至左结合的，它们是单目运算符、条件运算符、赋值运算符。其它的都是从左至右结合。当然，运算符是有级别的，级别高的先执行。具体请参考<a href="http://baike.baidu.com/view/1516130.htm" target="_blank" data_ue_src="http://baike.baidu.com/view/1516130.htm">百度百科C运算符</a>。</p>
<p style="margin-top:0px;margin-bottom:0px;font-family:'Times New Roman';"></p>
<h4 style="font-family:'Times New Roman';">关于C语言的特别运算符号</h4>
<p style="margin-top:0px;margin-bottom:0px;font-family:'Times New Roman';">自增++等，++的位置很重要，i++,表示用完i再自增1；而++i表示先做自增，然后再使用新的i值。</p>
<p style="margin-top:0px;margin-bottom:0px;font-family:'Times New Roman';">自减--，同理。这两个很有技巧的运算符使用时要特别小心。有时候让i用完，自增1很有用，例如最寻常的for循环，以及排序里面，上次做一道题目，是插入排序，其中我就搞岔了++i和i++。看来还需要好好修炼哪~</p>
<h3 style="background-color:#000000;color:#ffffff;padding:10px;font-family:'Times New Roman';">END</h3>
<p style="margin-top:0px;margin-bottom:0px;font-family:'Times New Roman';">by&nbsp;bibodeng&nbsp;2013-04-16&nbsp;21:45:44&nbsp;​</p>
<p style="margin-top:0px;margin-bottom:0px;font-family:'Times New Roman';"></p>
</div>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2013/04/15/知交/" itemprop="url">
                  知交
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">发表于</span>
            <time itemprop="dateCreated" datetime="2013-04-15T19:21:16+08:00" content="2013-04-15">
              2013-04-15
            </time>
          </span>

          

          
            
          

          
	
          
          
             <span id="/2013/04/15/知交/" class="leancloud_visitors" data-flag-title="知交">
               &nbsp; | &nbsp;
               <span class="post-meta-item-icon">
                 <i class="fa fa-eye"></i>
               </span>
               <span class="post-meta-item-text">阅读次数 </span>
               <span class="leancloud-visitors-count"></span>
              </span>
          

          
        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            
<link rel="style" href="/content/plugins/bibo_mark/article_bibo.css"> <div class="art_content">
<h3 style="font-family:'Times New Roman';line-height:normal;"></h3>
<h3 style="background-color:#000000;color:#ffffff;padding:10px;letter-spacing:1px;line-height:19.5px;">﻿谈友情</h3>
<p style="margin-top:0px;margin-bottom:0px;font-size:15px;font-weight:normal;letter-spacing:1px;line-height:19.5px;"></p>
<span style="font-size:15px;font-weight:normal;letter-spacing:1px;line-height:19.5px;">&nbsp;&nbsp;&nbsp;&nbsp;昨天晚上忽然收到伟权来的电话，他特地来问问我最近过得怎么样，我说，还不错！其实每天能看看书，编程序，做运动，这日子真的是挺惬意的，前段时间失眠频繁，为学习和其它事情烦扰，最要命的是我一躺下，精神就集中在身体的某一处，然后不能安顿思想。不过，随着学习变得更有目的性，心态变得淡定，我也慢慢能够睡好了。</span><br style="font-size:15px;font-weight:normal;letter-spacing:1px;line-height:19.5px;">
<br style="font-size:15px;font-weight:normal;letter-spacing:1px;line-height:19.5px;">
<span style="font-size:15px;font-weight:normal;letter-spacing:1px;line-height:19.5px;">&nbsp;&nbsp;&nbsp;&nbsp;记得五月天那首歌里面有一句“最怕空气忽然安静，最怕朋友突然的关心”，因为孤独惯了，能交流的仅仅自己而已，最多写成博文，付之一笑。很多表达无力，很多情感压抑，所以就久住在这围城里。胸中高山深谷，波澜壮阔，也绝对不会泛一点在表情里。@帷幕&nbsp;说我是第五型人，追求智慧，性格内向，偶尔开放。自认为是挺贴切的，而我的人生偶像，“大梦谁先觉，平生我自知”的作者——诸葛亮正是这种人。</span><br style="font-size:15px;font-weight:normal;letter-spacing:1px;line-height:19.5px;">
<p style="margin-top:0px;margin-bottom:0px;font-size:15px;font-weight:normal;letter-spacing:1px;line-height:19.5px;"></p>
<h3 style="background-color:#000000;color:#ffffff;padding:10px;letter-spacing:1px;line-height:19.5px;">知遇之友</h3>
<p style="margin-top:0px;margin-bottom:0px;font-size:15px;font-weight:normal;letter-spacing:1px;line-height:19.5px;">&nbsp;&nbsp;&nbsp;&nbsp;当年高考结束，我对语文老师说，愿学欧阳公，范文正公，出于贫困而秉聪慧，以勤奋而为有用之材。老师予以了鼓励，后来屡次见面，也颇觉得这是忘年之交。目前为止，我有多位知遇之友，他们懂得我的才能，鼓励我克服困难与自身缺陷，很大程度帮助我成为一个更好的人。</p>
<p style="margin-top:0px;margin-bottom:0px;font-size:15px;font-weight:normal;letter-spacing:1px;line-height:19.5px;"></p>
<p style="margin-top:0px;margin-bottom:0px;font-size:15px;font-weight:normal;letter-spacing:1px;line-height:19.5px;">“国栋者，国之大材者也”，是高中同桌小麦送给我的座右铭。大概是古文传记读多了，突然他蹦出一句这个传记格式来，这种评价估计只有在追悼会才能出现，作为座右铭，还是可以的。这个世界，比我们厉害的还有很多人，而要成为大材需要比绝大多数人要努力付出。而成为一个废柴挺容易，什么也不用做，就可以做到。</p>
<p style="margin-top:0px;margin-bottom:0px;font-size:15px;font-weight:normal;letter-spacing:1px;line-height:19.5px;"></p>
<p style="margin-top:0px;margin-bottom:0px;font-size:15px;font-weight:normal;letter-spacing:1px;line-height:19.5px;">&nbsp;&nbsp;&nbsp;&nbsp;“你跟我很像，大概我们的目的地是很靠近”，是规好师兄的勉励，记得大一的时候就开始看《我是一只IT小小鸟》，在CSDN和51CTO写博客，大三买了kindle，很多都是受到师兄的引导。而且师兄总是很nice地推荐一些书给我，很多都是非常有用的，让我觉得受益匪浅。和自己年长的人交流，就是有很多好处，让自己能见贤思齐。除了精神上的帮助，师兄也曾经给我以物质的鼓励，借新买的书我看，或者送书我。而我回家有年货的时候，也会惦记着师兄一份。当然，从师兄身上受的教益绝对不止一点点，例如师兄吃饭的时候，都是帮同伴拿好餐具，吃完了大家还分类回收，有一种助人为乐的心态。图书馆一些计算机专业的好书，都是师兄荐购的，后来我们校区不买书了，就越来越少荐购了。</p>
<p style="margin-top:0px;margin-bottom:0px;font-size:15px;font-weight:normal;letter-spacing:1px;line-height:19.5px;"></p>
<p style="margin-top:0px;margin-bottom:0px;font-size:15px;font-weight:normal;letter-spacing:1px;line-height:19.5px;">&nbsp;&nbsp;&nbsp;&nbsp;“果冻是那种personality，充满人格魅力的”，这是江老师对我的映像，而卫生老师也是屡次对我青眼有加，实在是感佩不已。陈卫生老师是典型的严师，考试的时候很严格，所以大多数人都得了70多分，很少有80多的，我觉得以我们的努力，获得70分左右才是正常的，而那些期末让我们个个高分通过的老师，不是我觉得靠谱的。我想很多时候，我们是从别人的眼中看自己，别人评价我们这样时，我们很可能还不够好，而别人的鼓励和引导，很可能让你更加努力成为一个personality的人。</p>
<p style="margin-top:0px;margin-bottom:0px;font-size:15px;font-weight:normal;letter-spacing:1px;line-height:19.5px;"></p>
<p style="margin-top:0px;margin-bottom:0px;font-size:15px;font-weight:normal;letter-spacing:1px;line-height:19.5px;">&nbsp;&nbsp;&nbsp;&nbsp;而杨教官，军训期间的十多天，我们也成了精神知交。印象很深刻的，他说了一句“古之成大事者，或无超拔之才，亦必有超拔之志”，令我引以为知己。之后很少联系，他对我说过一句“你小子很有前途”，哈哈，真的很开心听到教官这样说，来到大学里的都是前途无量的，而这其中4年后高下，必定在于其志之是否超拔也。</p>
<p style="margin-top:0px;margin-bottom:0px;font-size:15px;font-weight:normal;letter-spacing:1px;line-height:19.5px;"></p>
<h3 style="background-color:#000000;color:#ffffff;padding:10px;letter-spacing:1px;line-height:19.5px;">亲密朋友</h3>
<p style="margin-top:0px;margin-bottom:0px;font-size:15px;font-weight:normal;letter-spacing:1px;line-height:19.5px;">&nbsp;&nbsp;&nbsp;&nbsp;当然，最懂得你的行为性情的，是那些和你朝夕相处的，志同道合的朋友，他们陪伴身旁，帮你打饭防水，签到掩护。当然，有时候你会觉得宿舍里乱糟糟的，扰乱了思维的磁场，那么大可以去图书馆。但是宿舍里，大家一团和气才是最重要的。很幸运，三年多来我们宿舍，各位还是很和谐的，大概都是性格好的人。偶尔有小争吵，也是正常的。和志远搞怪，和桌升哥嬉笑，和广欣道长玩捡金子，和文杰求教问题，和伟昌两个打dota。这点点滴滴都是美好回忆，等到我们都毕业了，一定一定要记录下我们的伟大友谊（请不要误解为是《黄金时代》里的“伟大友谊”）。另外，思愿，大明，浩明，宝良都是相当好的球友，人品球技俱佳。人生知己两三，朋友若干，足以慰我平生了。</p>
<h3 style="background-color:#000000;color:#ffffff;padding:10px;letter-spacing:1px;line-height:19.5px;">发小玩伴</h3>
<p style="margin-top:0px;margin-bottom:0px;font-size:15px;font-weight:normal;letter-spacing:1px;line-height:19.5px;">&nbsp;&nbsp;&nbsp;&nbsp;小时候的发小，还有初中的玩伴，曾经一起疯狂，一起努力，当然是不能忘记的，老表，岚清，彬彬，召华，钟平，德康，甚至是红颜知己所比不了的（参看后面红颜知己）。然而，久违了，必定会有一定的神秘感，慢慢的生活上疏离了，但是相见总是很亲切。因为过去的我们，相当有默契，形影不离。曾几何时，一起在校园里畅谈，谈我们的男女感情，谈我们的理想抱负。在湖边坐下，看夕阳余辉，或者吹着凉风，漫步球场。现在每个人都有自己的生活，有自己的新朋友，但是，不知觉收到朋友的明信片，总会有那么一股暖意涌上心头，喜上眉头。哪怕卡片里面的只是只言片语，我都珍而藏之，留而念之。朋友之交，不在于物质多少赠与，而在于情意多少关怀。</p>
<p style="margin-top:0px;margin-bottom:0px;font-size:15px;font-weight:normal;letter-spacing:1px;line-height:19.5px;"></p>
<h3 style="background-color:#000000;color:#ffffff;padding:10px;letter-spacing:1px;line-height:19.5px;">红颜知己<br>
</h3>
<p style="margin-top:0px;margin-bottom:0px;font-size:15px;font-weight:normal;letter-spacing:1px;line-height:19.5px;">&nbsp;&nbsp;&nbsp;&nbsp;大学里，难免会喜欢一两个女孩，其实没有谈过一场恋爱，是一种遗憾。我所见的师兄中，很多很优秀的，都有女朋友。不记得在哪里看到一句话“男孩长大了，成为男生，脑子里就不仅仅能装下学习，还要能装下女生”，人在某一段时期，会做相应的事情，一是因为心态，而是因为生理。</p>
<p style="margin-top:0px;margin-bottom:0px;font-size:15px;font-weight:normal;letter-spacing:1px;line-height:19.5px;"></p>
<p style="margin-top:0px;margin-bottom:0px;font-size:15px;font-weight:normal;letter-spacing:1px;line-height:19.5px;">&nbsp;&nbsp;&nbsp;&nbsp;很不幸的，大学里追过女孩，但是以失败结尾，但是我追过的女生，都成为了红颜知己，彼此有话说，说话也有默契。只是不常联系，联系了也绝对不会去谈什么爱情了，而是当作一个知己来看待。聊聊小说人物，聊聊学习压力，还有那不痛不痒的音乐以及天气。很高兴，能够拥有这样的红颜知己，而我也算是个有情趣的男生吧。虽然不如苏轼般是世间奇男子，但好歹也是通情达理的人。偶尔有产生过尴尬，最终都相逢成一笑，久别成知己。</p>
<p style="margin-top:0px;margin-bottom:0px;font-size:15px;font-weight:normal;letter-spacing:1px;line-height:19.5px;"></p>
<p style="margin-top:0px;margin-bottom:0px;font-size:15px;font-weight:normal;letter-spacing:1px;line-height:19.5px;">&nbsp;&nbsp;&nbsp;&nbsp;也许有的是很多过去的回忆，以及好久不见的阔别情怀。就算是经常见面，也变得很淡很淡，因为都不愿意往感情的池子里扔块石头，漾起久叠的涟漪。有时候想起，放不下，那就姑且失眠一个晚上，也无不可。人，就是要真切的活着，很在乎就是很在乎，不必掩饰什么。</p>
<p style="margin-top:0px;margin-bottom:0px;font-size:15px;font-weight:normal;letter-spacing:1px;line-height:19.5px;"></p>
<p style="margin-top:0px;margin-bottom:0px;font-size:15px;font-weight:normal;letter-spacing:1px;line-height:19.5px;"></p>
<p style="margin-top:0px;margin-bottom:0px;font-size:15px;font-weight:normal;letter-spacing:1px;line-height:19.5px;">by&nbsp;bibodeng&nbsp;&nbsp;&nbsp;&nbsp;2013-04-15</p>
<p style="margin-top:0px;margin-bottom:0px;font-size:15px;font-weight:normal;letter-spacing:1px;line-height:19.5px;"></p>
<p style="margin-top:0px;margin-bottom:0px;font-size:15px;font-weight:normal;letter-spacing:1px;line-height:19.5px;"></p>
<p style="margin-top:0px;margin-bottom:0px;font-family:'Times New Roman';font-size:medium;line-height:normal;"></p>
<p style="margin-top:0px;margin-bottom:0px;font-family:'Times New Roman';font-size:medium;line-height:normal;"></p>
</div>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2013/04/14/学习SVN/" itemprop="url">
                  学习SVN
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">发表于</span>
            <time itemprop="dateCreated" datetime="2013-04-14T21:09:23+08:00" content="2013-04-14">
              2013-04-14
            </time>
          </span>

          

          
            
          

          
	
          
          
             <span id="/2013/04/14/学习SVN/" class="leancloud_visitors" data-flag-title="学习SVN">
               &nbsp; | &nbsp;
               <span class="post-meta-item-icon">
                 <i class="fa fa-eye"></i>
               </span>
               <span class="post-meta-item-text">阅读次数 </span>
               <span class="leancloud-visitors-count"></span>
              </span>
          

          
        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            
<link type="text/css" rel="stylesheet" href="/content/plugins/bibo_mark/article_bibo.css"> <div class="art_content"><p style="margin-top:0px;margin-bottom:0px;font-family:'Times New Roman';font-size:medium;line-height:normal;">​2013-04-02&nbsp;&nbsp;因为svn出现冲突，不能上传代码，很想砸电脑。</p>
<p style="margin-top:0px;margin-bottom:0px;font-family:'Times New Roman';font-size:medium;line-height:normal;">一个好的工具就像一柄神剑，如果你不会用，往往会伤到自己，现在我想说，SVN就是这样一柄神器。</p>
<p style="margin-top:0px;margin-bottom:0px;font-family:'Times New Roman';font-size:medium;line-height:normal;">长痛不如短痛，所以我打算一次性把SVN给搞懂，要不然就把电脑给砸了，很显然我只有一个选择。秉持着刘未朋的三个问题：&nbsp;本质是什么？有什么原则？有什么方法？&nbsp;（记不得是不是这三个问题了）我试着去克服svn这个困难。记得大二和师兄一起做项目的时候用上了svn，那时候还在windows下，用一个图形界面的svn在提交代码。现在想起来真的很可笑，当时每次我都去checkout，而不是update，而且每次checkout出来的代码，我都单独地放到一个文件夹下面，好好保存，当时我在想，这样就足够安全了。但是，现在我明白了，完全没有这个必要，因为版本库里面已经有每个版本的记录，可以拿到任何一个版本的代码。好吧，废话讲完了，让我们好好学习svn吧！</p>
<p style="margin-top:0px;margin-bottom:0px;font-family:'Times New Roman';font-size:medium;line-height:normal;"></p>
<p style="margin-top:0px;margin-bottom:0px;font-family:'Times New Roman';font-size:medium;line-height:normal;"></p>
<h3>SVN本质是什么？</h3>
<p></p>
<p style="margin-top:0px;margin-bottom:0px;font-family:'Times New Roman';font-size:medium;line-height:normal;">SVN是一个文件服务器，但是它是一个强大的文件服务器，能够记录所作的更改，使用于代码托管。有了SVN就能很大方便团队开发，各人都可以提交自己的代码。最重要的是，它能够按照修改来维护若干个版本，便于回复和更新。</p>
<p style="margin-top:0px;margin-bottom:0px;font-family:'Times New Roman';font-size:medium;line-height:normal;"></p>
<p style="margin-top:0px;margin-bottom:0px;font-family:'Times New Roman';font-size:medium;line-height:normal;">在我们的团队里面，就当作一个代码库管理工具来使用，将代码提交上去，但是我碰到的问题是，不会使用svn来维护多个版本，且遇到冲突的时候不知道如何解决。所以svn命令到了一半就运行不下去了，频频报错，搞得头大。半桶水害死人啊！使用的方法不对，所以搞得整天都在做解决冲突的问题，而且这冲突是我一个人制造出来的，那是因为我上传了一个代码包，这个代码包里面包含有大量的临时文件。所以，读《版本控制之道》到“如果你不小心上传了一堆临时文件到版本库中的话，你的项目经理会杀了你~”的时候，我会会心一笑。</p>
<p style="margin-top:0px;margin-bottom:0px;font-family:'Times New Roman';font-size:medium;line-height:normal;"></p>
<p style="margin-top:0px;margin-bottom:0px;font-family:'Times New Roman';font-size:medium;line-height:normal;">SVN的基本原理</p>
<p style="margin-top:0px;margin-bottom:0px;font-family:'Times New Roman';font-size:medium;line-height:normal;">SVN就是要求文件同步共享，最新的代码总是可以通过一个命令提交上去，甚至到了做了修改自动提交的。如git，以及ubuntu的软件中心都有着相似性，都是管理着一个库，其命令也具有相似性，如&nbsp;apt-get&nbsp;install&nbsp;xxx，&nbsp;git&nbsp;clone&nbsp;xxx,&nbsp;svn&nbsp;co&nbsp;xxx。但是这简单命令，根本满足不了开发人员的需求。SVN的难点就在于，如果两个client都做了修改，系统将怎样维护一致性。有的系统采用锁来同步，即排斥他人同时操作文件，必须一个个按照顺序来。如果有人做了修改，必须将新文件下载下来，然后处理矛盾，合并后上传到服务器。这样的合作方式，需要人为地处理冲突。</p>
<p style="margin-top:0px;margin-bottom:0px;font-family:'Times New Roman';font-size:medium;line-height:normal;"></p>
<p style="margin-top:0px;margin-bottom:0px;font-family:'Times New Roman';font-size:medium;line-height:normal;">SVN用户维护的工作拷贝，往往是代码库中的某一个版本，而且是版本库的一个子目录，例如1，2，3这样的目录就是某个版本。svn&nbsp;checkout&nbsp;&nbsp;PATH可以获得一份工作拷贝。</p>
<p style="margin-top:0px;margin-bottom:0px;font-family:'Times New Roman';font-size:medium;line-height:normal;">试验一下：&nbsp;cd&nbsp;/var/www</p>
<p style="margin-top:0px;margin-bottom:0px;font-family:'Times New Roman';font-size:medium;line-height:normal;">&nbsp;svn&nbsp;checkout&nbsp;<a href="https://svn.sinaapp.com/bibodeng" target="_blank" data_ue_src="https://svn.sinaapp.com/bibodeng">https://svn.sinaapp.com/bibodeng</a></p>
<p style="text-align:center;margin-top:0px;margin-bottom:0px;font-family:'Times New Roman';font-size:medium;line-height:normal;"><img src="http://www.wiz.cn/unzip/3eb90c0e-f584-11e0-a072-00237def97cc/6605ccfa-15cd-928a-0b00-365bdeba972f.5117/index_files/d2c46b4204ca182382637b43d4854edb.png" data_ue_src="http://www.wiz.cn/unzip/3eb90c0e-f584-11e0-a072-00237def97cc/6605ccfa-15cd-928a-0b00-365bdeba972f.5117/index_files/d2c46b4204ca182382637b43d4854edb.png"></p>
<p style="margin-top:0px;margin-bottom:0px;font-family:'Times New Roman';font-size:medium;line-height:normal;">获取了版本1的工作拷贝，在我的/var/www目录下面。</p>
<p style="margin-top:0px;margin-bottom:0px;font-family:'Times New Roman';font-size:medium;line-height:normal;">做了修改之后，则svn&nbsp;commit&nbsp;-m&nbsp;"上传时的日志消息&nbsp;Message"，叫做提交修改。</p>
<p style="margin-top:0px;margin-bottom:0px;font-family:'Times New Roman';font-size:medium;line-height:normal;">每做一次修改，且提交了，就能够看到版本号+1了。</p>
<p style="margin-top:0px;margin-bottom:0px;font-family:'Times New Roman';font-size:medium;line-height:normal;"></p>
<p style="margin-top:0px;margin-bottom:0px;font-family:'Times New Roman';font-size:medium;line-height:normal;">update会对那些过期的在本地工作拷贝下未修改过的进行更新，但是不会修改我们修改过的文件，这样保证了我们不愿意的修改svn不会自动帮我们做修改。修改过的文件可以commit，但是如果不是最新的，那么不能commit，因为会影响服务器端的修改，故而需要人update然后检查并且解决冲突，才能再次提交。&nbsp;&nbsp;commit只会提交更改过的那部分，而不会自动更新其余部分，所以这是一个混合版本，有些文件是老版本，有些是最新版的。我现在想要学会的就是怎么让我的编程很容易提交，而且很容易撤销，有了冲突的时候，能够及时地处理。到时候，叫SVN往前就往前，回滚就回滚，有种掌控历史的快感。</p>
<p style="margin-top:0px;margin-bottom:0px;font-family:'Times New Roman';font-size:medium;line-height:normal;"></p>
<p style="margin-top:0px;margin-bottom:0px;font-family:'Times New Roman';font-size:medium;line-height:normal;"></p>
<h3>SVN原则</h3>
<p></p>
<p style="margin-top:0px;margin-bottom:0px;font-family:'Times New Roman';font-size:medium;line-height:normal;">好，这里停顿一下，问问SVN有什么原则。</p>
<p style="margin-top:0px;margin-bottom:0px;font-family:'Times New Roman';font-size:medium;line-height:normal;">我现在体会到了SVN的原则就是KISS，懂得合作的原理，然后小心的更新提交。在做一件事情之前，考虑一下自己的目标，这样做的后果。比如我修改了一个文件Number.txt，假如要提交。那么我们最好先知道别人对网络版本库中的该文件做了什么，然后我们再看我们做的修改能否合并进去。所以就要先update，解决若干冲突，再commit。这样才能保证版本库的纯正。当然，在提交的时候，要尽可能逻辑整体的，而且频繁的更新。比如我在某个文件下面添加了一个函数，有那么十几行，在本地测试过了，可以很好运行，ok，提交，而且svn&nbsp;ci&nbsp;-m&nbsp;"添加了xx函数"&nbsp;记下几笔日记。这个频率大概是1小时1次，将来在小组里搞开发，可能大家都很高效，那么频繁提交可以让你的修改更早让人家看到，可以查出错误或者使用你的成果，有很大的好处。原则就是&nbsp;合作，保持整体简洁。</p>
<p style="margin-top:0px;margin-bottom:0px;font-family:'Times New Roman';font-size:medium;line-height:normal;"></p>
<p style="margin-top:0px;margin-bottom:0px;font-family:'Times New Roman';font-size:medium;line-height:normal;">next&nbsp;what？真正开始用SVN</p>
<p style="margin-top:0px;margin-bottom:0px;font-family:'Times New Roman';font-size:medium;line-height:normal;">老实说我之前还不会import命令，但是现在我知道了用它来导入一个本地文件作为版本库的一部分，这有点像git的init。然后会初始化checkout一次，然后做修改，提交。而且最好主干版本放在trunk下面，然后branches放分支，好吧，我承认自己不懂，继续看书。</p>
<p style="margin-top:0px;margin-bottom:0px;font-family:'Times New Roman';font-size:medium;line-height:normal;"></p>
<p style="margin-top:0px;margin-bottom:0px;font-family:'Times New Roman';font-size:medium;line-height:normal;">svn里面的几个命令是基础的，最常用的。例如status,&nbsp;update,commit,checkout,revert,resolved,log,diff等等。这里的命令一概不解释，网络上有很好的文档和教程，真正坐住板凳来看，绝对是可以学的很扎实的。</p>
<p style="margin-top:0px;margin-bottom:0px;font-family:'Times New Roman';font-size:medium;line-height:normal;">我发现svn甚至可以用diff来做一个补丁，也就是一个标示不同版本之间的不同之处的文件。而这个补丁，可以用patch命令来打补丁，全自动，比洗衣机还方便。</p>
<p style="margin-top:0px;margin-bottom:0px;font-family:'Times New Roman';font-size:medium;line-height:normal;"></p>
<p style="margin-top:0px;margin-bottom:0px;font-family:'Times New Roman';font-size:medium;line-height:normal;">还有一个意外就是，我居然可以追究到哪行代码是谁写的，使用svn&nbsp;blame&nbsp;可以看到文件中每一行的作者。这样统计谁写了多少代码，谁编写了错误的程序，谁要对代码负责&nbsp;追究起来就轻而易举了。当然我们使用这个不仅仅是为了追究责任，而是为了更好的“合作"。当我们知道这是谁写的代码时，结合svn&nbsp;log我们就可以追踪错误所在，从而更快地排除错误，获得正确的版本。我相信，这在web开发中是相当有用的。</p>
<p style="margin-top:0px;margin-bottom:0px;font-family:'Times New Roman';font-size:medium;line-height:normal;"></p>
<p style="margin-top:0px;margin-bottom:0px;font-family:'Times New Roman';font-size:medium;line-height:normal;">我犯过一个错误，那就是用操作系统的命令修改了svn工作目录下的文件和目录，例如用rm，mv&nbsp;一通瞎搞，然后搞得整个版本库乱七八糟，无法使用。看了文档才发现，原来要让svn管理一切，必须要让它知道我所做的所有动作。故而命令前面要加一个svn，变成这样：&nbsp;svn&nbsp;rm&nbsp;xxx。或者做了修改，让svn知道一下，例如拷贝了，要用svn&nbsp;add进到版本库中来。</p>
<p style="margin-top:0px;margin-bottom:0px;font-family:'Times New Roman';font-size:medium;line-height:normal;"></p>
<p style="margin-top:0px;margin-bottom:0px;font-family:'Times New Roman';font-size:medium;line-height:normal;">一切为了合作，一切为了共享，一切为了更加简单。</p>
<p style="margin-top:0px;margin-bottom:0px;font-family:'Times New Roman';font-size:medium;line-height:normal;"></p>
<p style="margin-top:0px;margin-bottom:0px;font-family:'Times New Roman';font-size:medium;line-height:normal;"></p>
<h3>SVN方法</h3>
<p></p>
<p style="margin-top:0px;margin-bottom:0px;font-family:'Times New Roman';font-size:medium;line-height:normal;">此处，沉默是金~</p>
<p style="margin-top:0px;margin-bottom:0px;font-family:'Times New Roman';font-size:medium;line-height:normal;">基本命令参考<a href="http://www.subversion.org.cn/tsvndoc/" data_ue_src="http://www.subversion.org.cn/tsvndoc/" target="_blank" rel="noopener">这个教程</a>。</p>
<p style="margin-top:0px;margin-bottom:0px;font-family:'Times New Roman';font-size:medium;line-height:normal;">update,&nbsp;checkout,&nbsp;commit,&nbsp;add,&nbsp;remove,&nbsp;move,&nbsp;copy,&nbsp;status,&nbsp;diff&nbsp;,&nbsp;revert,&nbsp;update,&nbsp;resolved.</p>
<p style="margin-top:0px;margin-bottom:0px;font-family:'Times New Roman';font-size:medium;line-height:normal;"></p>
<p style="margin-top:0px;margin-bottom:0px;font-family:'Times New Roman';font-size:medium;line-height:normal;">by bibodeng &nbsp; 2013-04-14</p>
<div><br>
</div>
</div>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2013/04/14/微信公众帐号验证/" itemprop="url">
                  微信公众帐号验证
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">发表于</span>
            <time itemprop="dateCreated" datetime="2013-04-14T10:14:24+08:00" content="2013-04-14">
              2013-04-14
            </time>
          </span>

          

          
            
          

          
	
          
          
             <span id="/2013/04/14/微信公众帐号验证/" class="leancloud_visitors" data-flag-title="微信公众帐号验证">
               &nbsp; | &nbsp;
               <span class="post-meta-item-icon">
                 <i class="fa fa-eye"></i>
               </span>
               <span class="post-meta-item-text">阅读次数 </span>
               <span class="leancloud-visitors-count"></span>
              </span>
          

          
        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            
<link type="text/css" rel="stylesheet" href="/content/plugins/bibo_mark/article_bibo.css"> <div class="art_content"><span style="font-family:'Times New Roman';font-size:medium;line-height:normal;">﻿</span><span style="font-family:'Times New Roman';font-size:medium;line-height:normal;">前段时间申请了一个微信公共帐号，想要在服务器端编程实现自动回复，同时也接触一下关于django编程，以继续发扬我在python的web道路。终于到现在，我才有时间​将这个过程记录下来，具体如下：</span><p style="margin-top:0px;margin-bottom:0px;font-family:'Times New Roman';font-size:medium;line-height:normal;">首先明确目标——成为微信公众号第三方开发者，通过消息API认证。</p>
<blockquote>
<p style="margin-top:0px;margin-bottom:0px;font-family:'Times New Roman';font-size:medium;line-height:normal;">使用的语言和框架&nbsp;：python的django</p>
<p style="margin-top:0px;margin-bottom:0px;font-family:'Times New Roman';font-size:medium;line-height:normal;">主机的平台：&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sae云平台</p>
<p style="margin-top:0px;margin-bottom:0px;font-family:'Times New Roman';font-size:medium;line-height:normal;">微信平台：&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;微信公众帐号</p>
<p style="margin-top:0px;margin-bottom:0px;font-family:'Times New Roman';font-size:medium;line-height:normal;"></p>
</blockquote>
<h3>具体过程</h3>
<p style="margin-top:0px;margin-bottom:0px;font-family:'Times New Roman';font-size:medium;line-height:normal;">当然，先要阅读微信的消息接口，其是通过微信服务器获取用户的回复，用get请求发送到我的服务器，然后我给予回应。所以只需要简单的编程就可以完成验证了。</p>
<p style="margin-top:0px;margin-bottom:0px;font-family:'Times New Roman';font-size:medium;line-height:normal;"></p>
<p style="margin-top:0px;margin-bottom:0px;font-family:'Times New Roman';font-size:medium;line-height:normal;">步骤1：申请微信公众帐号，需要填写若干资料，传送门<a href="http://mp.weixin.qq.com/" target="_blank" data_ue_src="http://mp.weixin.qq.com/"></a><a href="http://mp.weixin.qq.com" target="_blank" data_ue_src="http://mp.weixin.qq.com">http://mp.weixin.qq.com</a>&nbsp;，填写好后，则可以阅读其开放API文档，里面有提到如何验证：&nbsp;发送一个echochar,&nbsp;原样返回就可以了。但是其中要验证该get请求是否来自微信服务器，则需要详细核对生成的hash值。文档里面有范例php文件，可以直接下载研读。</p>
<p style="margin-top:0px;margin-bottom:0px;font-family:'Times New Roman';font-size:medium;line-height:normal;"></p>
<p style="margin-top:0px;margin-bottom:0px;font-family:'Times New Roman';font-size:medium;line-height:normal;"></p>
<p style="margin-top:0px;margin-bottom:0px;font-family:'Times New Roman';font-size:medium;line-height:normal;">步骤2：在sae上搭建应用，先有帐号，然后新建一个app，选择python或者php，如果选择了php可以使用微信提供的代码，google一下也会有很详细的教程。如果选用python，也可以参考本文或者文章后面的链接。</p>
<p style="margin-top:0px;margin-bottom:0px;font-family:'Times New Roman';font-size:medium;line-height:normal;"></p>
<p style="margin-top:0px;margin-bottom:0px;font-family:'Times New Roman';font-size:medium;line-height:normal;">在sae上搭建应用，需要在本地新建一个版本库，所以要在sae管理平台上先初始化第一个版本，这个版本什么代码都没有，只有两个配置文件config.yaml,index.wsgi，用svn&nbsp;check&nbsp;out到本地的工作目录。就可以看到有一个名为"1"的文件夹，也就是第一个版本。然后我们可以在该文件夹内构建django应用了，如果你安装好了django，那么可以到目录"1"下，然后在命令行运行&nbsp;</p>
<p style="margin-top:0px;margin-bottom:0px;font-family:'Times New Roman';font-size:medium;line-height:normal;"></p>
<table border="0" cellpadding="0" cellspacing="0" class=" noBorderTable ke-zeroborder" style="clear:both;margin-bottom:10px;word-break:break-all;color:#000000;font-family:'Times New Roman';"><tbody><tr><td class="gutter" style="border:1px dashed #dddddd !important;"><div class="line number1 index0 alt2" style="height:20px;">1</div>
</td>
<td class="code" style="border:1px dashed #dddddd !important;"><div class="container"><div class="line number1 index0 alt2" style="height:20px;"><code class="as3 plain">django-admin.py&nbsp;startproject&nbsp;mysite</code></div>
</div>
</td>
</tr>
</tbody>
</table>
<span style="font-family:'Times New Roman';font-size:medium;line-height:normal;">mysite是你的应用的名字，运行命令时要予以更换。</span><p style="margin-top:0px;margin-bottom:0px;font-family:'Times New Roman';font-size:medium;line-height:normal;"></p>
<p style="margin-top:0px;margin-bottom:0px;font-family:'Times New Roman';font-size:medium;line-height:normal;">然后就创建了本地工作目录，可是这个适合创建的目录处于1下面，我们最终要达到下面这个样子：tree命令察看目录树</p>
<p style="margin-top:0px;margin-bottom:0px;font-family:'Times New Roman';font-size:medium;line-height:normal;text-align:center;"><img src="http://www.wiz.cn/unzip/3eb90c0e-f584-11e0-a072-00237def97cc/b43de5cb-89ce-d7ec-7550-feeab9ae522b.5202/index_files/7c8bcebe8e6b2dd52d59a322f4647c02.png" data_ue_src="http://www.wiz.cn/unzip/3eb90c0e-f584-11e0-a072-00237def97cc/b43de5cb-89ce-d7ec-7550-feeab9ae522b.5202/index_files/7c8bcebe8e6b2dd52d59a322f4647c02.png"></p>
<p style="margin-top:0px;margin-bottom:0px;font-family:'Times New Roman';font-size:medium;line-height:normal;"></p>
<p style="margin-top:0px;margin-bottom:0px;font-family:'Times New Roman';font-size:medium;line-height:normal;">所以要将mysite下的文件或目录全部移动到1之下，因为mysite/暂时未纳入版本控制，所以可以手动拷贝后用svn将文件或目录纳入svn目录。故而形成manage.py在1之下，其他django文件在mysite（这里是scnuwriter）之下。</p>
<p style="margin-top:0px;margin-bottom:0px;font-family:'Times New Roman';font-size:medium;line-height:normal;"></p>
<p style="margin-top:0px;margin-bottom:0px;font-family:'Times New Roman';font-size:medium;line-height:normal;">&nbsp;&nbsp;&nbsp;</p>
<p style="margin-top:0px;margin-bottom:0px;font-family:'Times New Roman';font-size:medium;line-height:normal;">&nbsp;&nbsp;步骤3：&nbsp;在本地架设好django应用，然后用svn&nbsp;commit&nbsp;命令上传到sae服务器。这里需要参考sae的文档，关于搭建python开发环境的操作。有疑问的可以察看<a href="http://sae.sina.com.cn/?m=devcenter&amp;catId=289" data_ue_src="http://sae.sina.com.cn/?m=devcenter&amp;catId=289" target="_blank" rel="noopener">这里</a>。总之就是要配置好各种文件，上传代码就行了。</p>
<p style="margin-top:0px;margin-bottom:0px;font-family:'Times New Roman';font-size:medium;line-height:normal;"></p>
<p style="margin-top:0px;margin-bottom:0px;font-family:'Times New Roman';font-size:medium;line-height:normal;">步骤4：&nbsp;编写好微信验证的代码，代码如下&nbsp;view.py&nbsp;文件：</p>
<div id="highlighter_380844" class="syntaxhighlighter python" highlighter="brush:python;toolbar:false;" style="font-family:'Times New Roman';font-size:medium;line-height:normal;"><table border="0" cellpadding="0" cellspacing="0" class=" noBorderTable ke-zeroborder" style="clear:both;margin-bottom:10px;word-break:break-all;"><tbody><tr><td class="gutter" style="border:1px dashed #dddddd !important;"><div class="line number1 index0 alt2" style="height:20px;">1</div>
<div class="line number2 index1 alt1" style="height:20px;">2</div>
<div class="line number3 index2 alt2" style="height:20px;">3</div>
<div class="line number4 index3 alt1" style="height:20px;">4</div>
<div class="line number5 index4 alt2" style="height:20px;">5</div>
<div class="line number6 index5 alt1" style="height:20px;">6</div>
<div class="line number7 index6 alt2" style="height:20px;">7</div>
<div class="line number8 index7 alt1" style="height:20px;">8</div>
<div class="line number9 index8 alt2" style="height:20px;">9</div>
<div class="line number10 index9 alt1" style="height:20px;">10</div>
<div class="line number11 index10 alt2" style="height:20px;">11</div>
<div class="line number12 index11 alt1" style="height:20px;">12</div>
<div class="line number13 index12 alt2" style="height:20px;">13</div>
<div class="line number14 index13 alt1" style="height:20px;">14</div>
<div class="line number15 index14 alt2" style="height:20px;">15</div>
<div class="line number16 index15 alt1" style="height:20px;">16</div>
<div class="line number17 index16 alt2" style="height:20px;">17</div>
<div class="line number18 index17 alt1" style="height:20px;">18</div>
<div class="line number19 index18 alt2" style="height:20px;">19</div>
<div class="line number20 index19 alt1" style="height:20px;">20</div>
<div class="line number21 index20 alt2" style="height:20px;">21</div>
<div class="line number22 index21 alt1" style="height:20px;">22</div>
<div class="line number23 index22 alt2" style="height:20px;">23</div>
<div class="line number24 index23 alt1" style="height:20px;">24</div>
<div class="line number25 index24 alt2" style="height:20px;">25</div>
<div class="line number26 index25 alt1" style="height:20px;">26</div>
</td>
<td class="code" style="border:1px dashed #dddddd !important;"><div class="container"><div class="line number1 index0 alt2" style="height:20px;"><code class="python comments">#&nbsp;-*-&nbsp;coding:&nbsp;utf-8&nbsp;-*-&nbsp;&nbsp;</code></div>
<div class="line number2 index1 alt1" style="height:20px;"><code class="python keyword">from</code>&nbsp;<code class="python plain">django.http&nbsp;</code><code class="python keyword">import</code>&nbsp;<code class="python plain">HttpResponse&nbsp;&nbsp;</code></div>
<div class="line number3 index2 alt2" style="height:20px;"><code class="python keyword">from</code>&nbsp;<code class="python plain">django.template&nbsp;</code><code class="python keyword">import</code>&nbsp;<code class="python plain">RequestContext,&nbsp;Template&nbsp;&nbsp;</code></div>
<div class="line number4 index3 alt1" style="height:20px;"><code class="python keyword">from</code>&nbsp;<code class="python plain">django.views.decorators.csrf&nbsp;</code><code class="python keyword">import</code>&nbsp;<code class="python plain">csrf_exempt&nbsp;&nbsp;</code></div>
<div class="line number5 index4 alt2" style="height:20px;"><code class="python keyword">from</code>&nbsp;<code class="python plain">django.utils.encoding&nbsp;</code><code class="python keyword">import</code>&nbsp;<code class="python plain">smart_str,&nbsp;smart_unicode&nbsp;</code></div>
<div class="line number6 index5 alt1" style="height:20px;"><code class="python keyword">import</code>&nbsp;<code class="python plain">hashlib</code></div>
<div class="line number7 index6 alt2" style="height:20px;"></div>
<div class="line number8 index7 alt1" style="height:20px;"></div>
<div class="line number9 index8 alt2" style="height:20px;"><code class="python plain">TOKEN&nbsp;</code><code class="python keyword">=</code>&nbsp;<code class="python string">"mytoken"</code></div>
<div class="line number10 index9 alt1" style="height:20px;"></div>
<div class="line number11 index10 alt2" style="height:20px;"><code class="python comments">#&nbsp;to&nbsp;verify&nbsp;the&nbsp;API&nbsp;server&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code></div>
<div class="line number12 index11 alt1" style="height:20px;"><code class="python keyword">def</code>&nbsp;<code class="python plain">checkSignature(request):&nbsp;&nbsp;</code></div>
<div class="line number13 index12 alt2" style="height:20px;"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python keyword">global</code>&nbsp;<code class="python plain">TOKEN&nbsp;&nbsp;</code></div>
<div class="line number14 index13 alt1" style="height:20px;"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">signature&nbsp;</code><code class="python keyword">=</code>&nbsp;<code class="python plain">request.GET.get(</code><code class="python string">"signature"</code><code class="python plain">,&nbsp;</code><code class="python color1">None</code><code class="python plain">)</code></div>
<div class="line number15 index14 alt2" style="height:20px;"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">timestamp&nbsp;</code><code class="python keyword">=</code>&nbsp;<code class="python plain">request.GET.get(</code><code class="python string">"timestamp"</code><code class="python plain">,&nbsp;</code><code class="python color1">None</code><code class="python plain">)</code></div>
<div class="line number16 index15 alt1" style="height:20px;"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">nonce&nbsp;</code><code class="python keyword">=</code>&nbsp;<code class="python plain">request.GET.get(</code><code class="python string">"nonce"</code><code class="python plain">,&nbsp;</code><code class="python color1">None</code><code class="python plain">)</code></div>
<div class="line number17 index16 alt2" style="height:20px;"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">echoStr&nbsp;</code><code class="python keyword">=</code>&nbsp;<code class="python plain">request.GET.get(</code><code class="python string">"echostr"</code><code class="python plain">,</code><code class="python color1">None</code><code class="python plain">)</code></div>
<div class="line number18 index17 alt1" style="height:20px;"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">token&nbsp;</code><code class="python keyword">=</code>&nbsp;<code class="python plain">TOKEN&nbsp;&nbsp;</code></div>
<div class="line number19 index18 alt2" style="height:20px;"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">tmpList&nbsp;</code><code class="python keyword">=</code>&nbsp;<code class="python plain">[token,timestamp,nonce]&nbsp;&nbsp;</code></div>
<div class="line number20 index19 alt1" style="height:20px;"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">tmpList.sort()&nbsp;&nbsp;</code></div>
<div class="line number21 index20 alt2" style="height:20px;"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">tmpstr&nbsp;</code><code class="python keyword">=</code>&nbsp;<code class="python string">"%s%s%s"</code>&nbsp;<code class="python keyword">%</code>&nbsp;<code class="python functions">tuple</code><code class="python plain">(tmpList)&nbsp;&nbsp;</code></div>
<div class="line number22 index21 alt1" style="height:20px;"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">tmpstr&nbsp;</code><code class="python keyword">=</code>&nbsp;<code class="python plain">hashlib.sha1(tmpstr).hexdigest()</code></div>
<div class="line number23 index22 alt2" style="height:20px;"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python keyword">if</code>&nbsp;<code class="python plain">tmpstr&nbsp;</code><code class="python keyword">=</code><code class="python keyword">=</code>&nbsp;<code class="python plain">signature:&nbsp;</code></div>
<div class="line number24 index23 alt1" style="height:20px;"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python keyword">return</code>&nbsp;<code class="python plain">HttpResponse(echoStr)</code></div>
<div class="line number25 index24 alt2" style="height:20px;"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python keyword">else</code><code class="python plain">:&nbsp;&nbsp;</code></div>
<div class="line number26 index25 alt1" style="height:20px;"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python keyword">return</code>&nbsp;<code class="python color1">None</code></div>
</div>
</td>
</tr>
</tbody>
</table>
</div>
<p style="margin-top:0px;margin-bottom:0px;font-family:'Times New Roman';font-size:medium;line-height:normal;">当然如果不怕安全性的损失，可以不验证这是微信服务器发来的get请求，而直接在第17行后面return&nbsp;HttpResponse(echoStr)&nbsp;就可以了。从微信的示例php文件中可以看出来，它将验证封装在一个专门的函数中供调用。但其实验证的内容与返回的东西无关。很多教程里面写的是return&nbsp;echoStr，我搞了半天才发现不行，返回的不是一个http响应，故而需要对echoStr做一个HttpResponse的包装。</p>
<p style="margin-top:0px;margin-bottom:0px;font-family:'Times New Roman';font-size:medium;line-height:normal;"></p>
<p style="margin-top:0px;margin-bottom:0px;font-family:'Times New Roman';font-size:medium;line-height:normal;">另外需要在url设置里面进行设置，然后在微信发送验证时填写url的时候填写对应的url。例如，在django工作目录下面修改url.py如下：</p>
<div id="highlighter_298508" class="syntaxhighlighter python" highlighter="brush:python;toolbar:false;" style="font-family:'Times New Roman';font-size:medium;line-height:normal;"><table border="0" cellpadding="0" cellspacing="0" class=" noBorderTable ke-zeroborder" style="clear:both;margin-bottom:10px;word-break:break-all;"><tbody><tr><td class="gutter" style="border:1px dashed #dddddd !important;"><div class="line number1 index0 alt2" style="height:20px;">1</div>
<div class="line number2 index1 alt1" style="height:20px;">2</div>
<div class="line number3 index2 alt2" style="height:20px;">3</div>
<div class="line number4 index3 alt1" style="height:20px;">4</div>
<div class="line number5 index4 alt2" style="height:20px;">5</div>
<div class="line number6 index5 alt1" style="height:20px;">6</div>
<div class="line number7 index6 alt2" style="height:20px;">7</div>
<div class="line number8 index7 alt1" style="height:20px;">8</div>
<div class="line number9 index8 alt2" style="height:20px;">9</div>
<div class="line number10 index9 alt1" style="height:20px;">10</div>
<div class="line number11 index10 alt2" style="height:20px;">11</div>
<div class="line number12 index11 alt1" style="height:20px;">12</div>
<div class="line number13 index12 alt2" style="height:20px;">13</div>
</td>
<td class="code" style="border:1px dashed #dddddd !important;"><div class="container"><div class="line number1 index0 alt2" style="height:20px;"><code class="python keyword">from</code>&nbsp;<code class="python plain">django.conf.urls&nbsp;</code><code class="python keyword">import</code>&nbsp;<code class="python plain">patterns,&nbsp;include,&nbsp;url</code></div>
<div class="line number2 index1 alt1" style="height:20px;"></div>
<div class="line number3 index2 alt2" style="height:20px;"><code class="python comments">#&nbsp;Uncomment&nbsp;the&nbsp;next&nbsp;two&nbsp;lines&nbsp;to&nbsp;enable&nbsp;the&nbsp;admin:</code></div>
<div class="line number4 index3 alt1" style="height:20px;"><code class="python comments">#&nbsp;from&nbsp;django.contrib&nbsp;import&nbsp;admin</code></div>
<div class="line number5 index4 alt2" style="height:20px;"><code class="python comments">#&nbsp;admin.autodiscover()</code></div>
<div class="line number6 index5 alt1" style="height:20px;"><code class="python keyword">from</code>&nbsp;<code class="python plain">scnuwriter.views&nbsp;</code><code class="python keyword">import</code>&nbsp;<code class="python keyword">*</code></div>
<div class="line number7 index6 alt2" style="height:20px;"></div>
<div class="line number8 index7 alt1" style="height:20px;"><code class="python plain">urlpatterns&nbsp;</code><code class="python keyword">=</code>&nbsp;<code class="python plain">patterns('',</code></div>
<div class="line number9 index8 alt2" style="height:20px;"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python comments">#&nbsp;Examples:</code></div>
<div class="line number10 index9 alt1" style="height:20px;"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python comments">#&nbsp;url(r'^$',&nbsp;'scnuwriter.views.home',&nbsp;name='home'),</code></div>
<div class="line number11 index10 alt2" style="height:20px;"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python comments">#&nbsp;url(r'^scnuwriter/',&nbsp;include('scnuwriter.foo.urls')),</code></div>
<div class="line number12 index11 alt1" style="height:20px;"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">url(r</code><code class="python string">'^$'</code><code class="python plain">,&nbsp;checkSignature),</code></div>
<div class="line number13 index12 alt2" style="height:20px;"><code class="python plain">)</code></div>
</div>
</td>
</tr>
</tbody>
</table>
</div>
<p style="margin-top:0px;margin-bottom:0px;font-family:'Times New Roman';font-size:medium;line-height:normal;">第12行表示，在url中什么也不加，如<a href="http://scnuwriter.sinaapp.com" data_ue_src="http://scnuwriter.sinaapp.com" target="_blank" rel="noopener">http://scnuwriter.sinaapp.com</a>&nbsp;这样就可以访问checkSignature了。每次在本地目录做了更改，都需要在终端中用svn命令commit一下，这个就不用多说了。</p>
<p style="margin-top:0px;margin-bottom:0px;font-family:'Times New Roman';font-size:medium;line-height:normal;"></p>
<p style="margin-top:0px;margin-bottom:0px;font-family:'Times New Roman';font-size:medium;line-height:normal;">步骤4：验证</p>
<p style="margin-top:0px;margin-bottom:0px;font-family:'Times New Roman';font-size:medium;line-height:normal;">验证的原理很简单，就是确认这个东西是微信服务器发来的，而且把这个东西原样返回就行了。登陆微信公众平台，填写url和token（在本例子中就是程序中的TOKEN,也就是"mytoken"），按验证就可以了。</p>
<p style="margin-top:0px;margin-bottom:0px;font-family:'Times New Roman';font-size:medium;line-height:normal;"><img src="http://www.wiz.cn/unzip/3eb90c0e-f584-11e0-a072-00237def97cc/b43de5cb-89ce-d7ec-7550-feeab9ae522b.5202/index_files/f82cc46a4bb22d15151795284be52e5e.jpg" width="354" height="225" alt="" border="0"></p>
<p style="margin-top:0px;margin-bottom:0px;font-family:'Times New Roman';font-size:medium;line-height:normal;">成功会提示成功成为开发者，如果失败，会提示你你的服务器响应不正确。</p>
<p style="margin-top:0px;margin-bottom:0px;font-family:'Times New Roman';font-size:medium;line-height:normal;"><img src="http://www.wiz.cn/unzip/3eb90c0e-f584-11e0-a072-00237def97cc/b43de5cb-89ce-d7ec-7550-feeab9ae522b.5202/index_files/7851a041e4435b623f074b87e0bbca2a.png" width="600" height="250" alt="" border="0"></p>
<p style="margin-top:0px;margin-bottom:0px;font-family:'Times New Roman';font-size:medium;line-height:normal;">ok，搞定。结果如下，可以进行下一步的微信公众帐号的开发了!</p>
<p style="margin-top:0px;margin-bottom:0px;font-family:'Times New Roman';font-size:medium;line-height:normal;"></p>
<p style="margin-top:0px;margin-bottom:0px;font-family:'Times New Roman';font-size:medium;line-height:normal;">参考链接：</p>
<p style="margin-top:0px;margin-bottom:0px;font-family:'Times New Roman';font-size:medium;line-height:normal;">&nbsp;<a href="http://mp.weixin.qq.com/wiki/index.php?title=%E6%B6%88%E6%81%AF%E6%8E%A5%E5%8F%A3%E6%8C%87%E5%8D%97" data_ue_src="http://mp.weixin.qq.com/wiki/index.php?title=%E6%B6%88%E6%81%AF%E6%8E%A5%E5%8F%A3%E6%8C%87%E5%8D%97" target="_blank" rel="noopener">微信接口文档</a>&nbsp;</p>
<p style="margin-top:0px;margin-bottom:0px;font-family:'Times New Roman';font-size:medium;line-height:normal;"><a href="/admin/ http:/www.cnblogs.com/txw1958/archive/2013/01/24/weixin-if1-enable.html" data_ue_src=" http://www.cnblogs.com/txw1958/archive/2013/01/24/weixin-if1-enable.html">启用接口（php）,通过微信验证</a><a></a></p>
<p style="margin-top:0px;margin-bottom:0px;font-family:'Times New Roman';font-size:medium;line-height:normal;"><a href="http://blog.csdn.net/liushuaikobe/article/details/8453716" data_ue_src="http://blog.csdn.net/liushuaikobe/article/details/8453716" target="_blank" rel="noopener">微信机器人python</a></p>
<p style="margin-top:0px;margin-bottom:0px;font-family:'Times New Roman';font-size:medium;line-height:normal;"><a href="http://djangobook.py3k.cn/2.0/" target="_blank" data_ue_src="http://djangobook.py3k.cn/2.0/">django&nbsp;手册</a></p>
<p style="margin-top:0px;margin-bottom:0px;font-family:'Times New Roman';font-size:medium;line-height:normal;"><a href="http://sae.sina.com.cn/?m=devcenter&amp;catId=289" target="_blank" data_ue_src="http://sae.sina.com.cn/?m=devcenter&amp;catId=289">sae&nbsp;python部署</a></p>
</div>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
  </section>

  
  <nav class="pagination">
    <a class="extend prev" rel="prev" href="/page/9/"><i class="fa fa-angle-left"></i></a><a class="page-number" href="/">1</a><span class="space">&hellip;</span><a class="page-number" href="/page/9/">9</a><span class="page-number current">10</span><a class="page-number" href="/page/11/">11</a><span class="space">&hellip;</span><a class="page-number" href="/page/19/">19</a><a class="extend next" rel="next" href="/page/11/"><i class="fa fa-angle-right"></i></a>
  </nav>



          </div>
          


          

        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    <div class="sidebar-inner">

      

      

      <section class="site-overview sidebar-panel  sidebar-panel-active ">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <img class="site-author-image" itemprop="image"
               src="/images/bitcoin-cash-logo.svg"
               alt="bibodeng" />
          <p class="site-author-name" itemprop="name">bibodeng</p>
          <p class="site-description motion-element" itemprop="description">区块链爱好者，互联网从业者</p>
        </div>
        <nav class="site-state motion-element">
          <div class="site-state-item site-state-posts">
            <a href="/archives">
              <span class="site-state-item-count">185</span>
              <span class="site-state-item-name">日志</span>
            </a>
          </div>

          

          
            <div class="site-state-item site-state-tags">
              <a href="/tags">
                <span class="site-state-item-count">17</span>
                <span class="site-state-item-name">标签</span>
              </a>
            </div>
          

        </nav>

        

        <div class="links-of-author motion-element">
          
            
              <span class="links-of-author-item">
                <a href="https://github.com/bibodeng" target="_blank" title="Github">
                  
                    <i class="fa fa-fw fa-globe"></i>
                  
                  Github
                </a>
              </span>
            
              <span class="links-of-author-item">
                <a href="https://twitter.com/bibodeng" target="_blank" title="Twitter">
                  
                    <i class="fa fa-fw fa-twitter"></i>
                  
                  Twitter
                </a>
              </span>
            
              <span class="links-of-author-item">
                <a href="http://weibo.com/bibodeng" target="_blank" title="Weibo">
                  
                    <i class="fa fa-fw fa-weibo"></i>
                  
                  Weibo
                </a>
              </span>
            
          
        </div>

        
        

        
        
          <div class="links-of-blogroll motion-element links-of-blogroll-inline">
            <div class="links-of-blogroll-title">
              <i class="fa  fa-fw fa-globe"></i>
              Links
            </div>
            <ul class="links-of-blogroll-list">
              
                <li class="links-of-blogroll-item">
                  <a href="https://ifwallet.com" title="IFWallet" target="_blank">IFWallet</a>
                </li>
              
                <li class="links-of-blogroll-item">
                  <a href="https://ifpass.cash" title="IFPassword" target="_blank">IFPassword</a>
                </li>
              
            </ul>
          </div>
        

      </section>

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright" >
  
  &copy; 
  <span itemprop="copyrightYear">2018</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">bibodeng</span>
</div>

<div class="powered-by">
  由 <a class="theme-link" href="http://hexo.io">Hexo</a> 强力驱动
</div>

<div class="theme-info">
  主题 -
  <a class="theme-link" href="https://github.com/iissnan/hexo-theme-next">
    NexT.Mist
  </a>
</div>

        

        
      </div>
    </footer>

    <div class="back-to-top">
      <i class="fa fa-arrow-up"></i>
    </div>
  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  



  
  <script type="text/javascript" src="/vendors/jquery/index.js?v=2.1.3"></script>

  
  <script type="text/javascript" src="/vendors/fastclick/lib/fastclick.min.js?v=1.0.6"></script>

  
  <script type="text/javascript" src="/vendors/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>

  
  <script type="text/javascript" src="/vendors/velocity/velocity.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/vendors/velocity/velocity.ui.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/vendors/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.0.1"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.0.1"></script>



  
  

  

  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.0.1"></script>



  



  



  
  
  

  

  
  <script src="https://cdn1.lncld.net/static/js/av-core-mini-0.6.1.js"></script>
  <script>AV.initialize("RrMSWOa8nuCnCCWn8TyPa7Od-gzGzoHsz", "8xnzit83sqv6vUEuXlsEWe0s");</script>
  <script>
    function showTime(Counter) {
      var query = new AV.Query(Counter);
      var entries = [];
      var $visitors = $(".leancloud_visitors");

      $visitors.each(function () {
        entries.push( $(this).attr("id").trim() );
      });

      query.containedIn('url', entries);
      query.find()
        .done(function (results) {
          var COUNT_CONTAINER_REF = '.leancloud-visitors-count';

          if (results.length === 0) {
            $visitors.find(COUNT_CONTAINER_REF).text(0);
            return;
          }

          for (var i = 0; i < results.length; i++) {
            var item = results[i];
            var url = item.get('url');
            var time = item.get('time');
            var element = document.getElementById(url);

            $(element).find(COUNT_CONTAINER_REF).text(time);
          }
        })
        .fail(function (object, error) {
          console.log("Error: " + error.code + " " + error.message);
        });
    }

    function addCount(Counter) {
      var $visitors = $(".leancloud_visitors");
      var url = $visitors.attr('id').trim();
      var title = $visitors.attr('data-flag-title').trim();
      var query = new AV.Query(Counter);

      query.equalTo("url", url);
      query.find({
        success: function(results) {
          if (results.length > 0) {
            var counter = results[0];
            counter.fetchWhenSave(true);
            counter.increment("time");
            counter.save(null, {
              success: function(counter) {
                var $element = $(document.getElementById(url));
                $element.find('.leancloud-visitors-count').text(counter.get('time'));
              },
              error: function(counter, error) {
                console.log('Failed to save Visitor num, with error message: ' + error.message);
              }
            });
          } else {
            var newcounter = new Counter();
            /* Set ACL */
            var acl = new AV.ACL();
            acl.setPublicReadAccess(true);
            acl.setPublicWriteAccess(true);
            newcounter.setACL(acl);
            /* End Set ACL */
            newcounter.set("title", title);
            newcounter.set("url", url);
            newcounter.set("time", 1);
            newcounter.save(null, {
              success: function(newcounter) {
                var $element = $(document.getElementById(url));
                $element.find('.leancloud-visitors-count').text(newcounter.get('time'));
              },
              error: function(newcounter, error) {
                console.log('Failed to create');
              }
            });
          }
        },
        error: function(error) {
          console.log('Error:' + error.code + " " + error.message);
        }
      });
    }

    $(function() {
      var Counter = AV.Object.extend("Counter");
      if ($('.leancloud_visitors').length == 1) {
        addCount(Counter);
      } else if ($('.post-title-link').length > 1) {
        showTime(Counter);
      }
    });
  </script>



  

</body>
</html>
